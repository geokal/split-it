@page "/researchGroupDetails"
@attribute [Microsoft.AspNetCore.Authorization.AllowAnonymous]
@layout FullScreenLayout
@using Microsoft.EntityFrameworkCore
@using Microsoft.Extensions.Logging
@using QuizManager.Data
@using QuizManager.Models
@using System.Security.Claims
@inject IDbContextFactory<AppDbContext> DbContextFactory
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime

<style>
    .expandable-section {
        margin-bottom: 15px;
    }

    .section-header {
        cursor: pointer;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 6px;
        border: 1px solid black;
        transition: all 0.3s ease;
        display: flex;
        justify-content: between;
        align-items: center;
    }

        .section-header:hover {
            background: #e9ecef;
            border-color: #0073aa;
        }

    .section-title-expandable {
        color: #0073aa;
        margin: 0;
        flex: 1;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .section-content {
        padding: 20px;
        border: 1px solid black;
        border-top: none;
        border-radius: 0 0 6px 6px;
        background: white;
    }

    .chevron-icon {
        transition: transform 0.3s ease;
    }

    .chevron-rotated {
        transform: rotate(180deg);
    }

    .research-group-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background-color: #fff;
        min-height: 100vh;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
        line-height: 1.6;
        color: #333;
    }

    .header-section {
        background: linear-gradient(135deg, #2d3748 0%, #005a87 100%);
        color: white;
        padding: 40px 30px;
        border-radius: 8px;
        margin-bottom: 30px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        position: relative;
        overflow: hidden;
    }

        .header-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(100px, -100px);
        }

    .info-card {
        background: #2d3748;
        border-radius: 8px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        border: 1px solid black;
        transition: box-shadow 0.3s ease;
    }

        .info-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
        }

    .section-title {
        color: #2d3748;
        border-bottom: 2px solid #2d3748;
        padding-bottom: 12px;
        margin-bottom: 20px;
        font-weight: 600;
        font-size: 1.4em;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .detail-item {
        margin-bottom: 15px;
        padding: 12px 15px;
        border-radius: 6px;
        background-color: #f9f9f9;
        border-left: 3px solid #2d3748;
    }

    .detail-label {
        font-weight: 600;
        color: #2c3338;
        margin-bottom: 5px;
        font-size: 0.95em;
    }

    .detail-value {
        color: #50575e;
        font-size: 1em;
    }

    .social-links {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 20px;
    }

    .social-icon {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: white;
        text-decoration: none;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

        .social-icon:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

    .website {
        background-color: #0073aa;
    }

    .facebook {
        background-color: #1877f2;
    }

    .twitter {
        background-color: #1da1f2;
    }

    .linkedin {
        background-color: #0a66c2;
    }

    .youtube {
        background-color: #ff0000;
    }

    .member-card, .project-card, .publication-card {
        background: #fff;
        border-radius: 6px;
        padding: 20px;
        margin-bottom: 15px;
        border: 1px solid #e1e1e1;
        transition: all 0.3s ease;
    }

        .member-card:hover, .project-card:hover {
            border-color: #0073aa;
            box-shadow: 0 2px 8px rgba(0,115,170,0.1);
        }

    .badge-custom {
        font-size: 0.85em;
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: 500;
        margin: 2px;
    }

    .back-button {
        background-color: #727272;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 4px;
        cursor: pointer;
        margin-bottom: 20px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: background-color 0.3s ease;
        font-weight: 500;
    }

        .back-button:hover {
            background-color: #595959;
        }

    .logo-container {
        text-align: center;
        margin-bottom: 20px;
    }

    .research-group-logo {
        max-width: 180px;
        max-height: 180px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        border: 3px solid white;
    }

    .team-image {
        width: 100%;
        max-height: 300px;
        object-fit: cover;
        border-radius: 8px;
        margin-bottom: 20px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .video-container {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        border-radius: 8px;
        margin-top: 15px;
        background: #000;
    }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

    .wp-button {
        background: #0073aa;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 3px;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        font-size: 0.95em;
        transition: background 0.3s ease;
    }

        .wp-button:hover {
            background: #005a87;
            color: white;
            text-decoration: none;
        }

    .wp-button-outline {
        background: transparent;
        color: #0073aa;
        border: 1px solid #0073aa;
        padding: 10px 20px;
        border-radius: 3px;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        font-size: 0.95em;
        transition: all 0.3s ease;
    }

        .wp-button-outline:hover {
            background: #0073aa;
            color: white;
            text-decoration: none;
        }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .stat-item {
        text-align: center;
        padding: 15px;
        background: #f9f9f9;
        border-radius: 6px;
        border-left: 4px solid #0073aa;
    }

    .stat-number {
        font-size: 1.8em;
        font-weight: bold;
        color: #0073aa;
        display: block;
    }

    .stat-label {
        font-size: 0.9em;
        color: #666;
        margin-top: 5px;
    }

    .loading-spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #0073aa;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @@keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .project-card {
        background: #fff;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        border: 1px solid #e1e1e1;
        transition: all 0.3s ease;
    }

        .project-card:hover {
            border-color: #0073aa;
            box-shadow: 0 2px 8px rgba(0,115,170,0.1);
        }

    .project-header {
        transition: background-color 0.2s ease;
    }

        .project-header:hover {
            background-color: #f8f9fa;
        }

    .project-details {
        animation: fadeIn 0.3s ease-in-out;
    }

    @@keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .stat-item {
        text-align: center;
        padding: 15px;
        background: #f9f9f9;
        border-radius: 6px;
        border-left: 4px solid #0073aa;
        transition: all 0.3s ease;
        cursor: pointer;
    }

        .stat-item:hover {
            background: #e3f2fd;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,115,170,0.2);
            border-left-color: #005a87;
        }

    .stat-number {
        font-size: 1.8em;
        font-weight: bold;
        color: #0073aa;
        display: block;
        transition: color 0.3s ease;
    }

    .stat-item:hover .stat-number {
        color: #005a87;
    }

    .stat-label {
        font-size: 0.9em;
        color: #666;
        margin-top: 5px;
        transition: color 0.3s ease;
    }

    .stat-item:hover .stat-label {
        color: #333;
        font-weight: 500;
    }

    .header-media-absolute {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
    }

    .video-thumbnail-absolute {
        margin-bottom: 15px;
    }

    .social-links-absolute {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        justify-content: flex-end;
    }

    .profile-subsection {
        padding: 15px;
        border-radius: 6px;
        background: #f8f9fa;
        margin-bottom: 15px;
        border-left: 4px solid #2d3748;
    }

        .profile-subsection:last-child {
            margin-bottom: 0;
        }

    /* For the grid layout */
    .col-md-4 .profile-subsection {
        height: 100%;
        min-height: 120px;
        display: flex;
        flex-direction: column;
    }

        .col-md-4 .profile-subsection h6 {
            flex-shrink: 0;
        }

        .col-md-4 .profile-subsection .d-flex {
            flex-grow: 1;
            align-content: flex-start;
        }

    .research-profile-section {
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border: 1px solid #e9ecef;
    }

    .presentation-section {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
    }

    .presentation-card {
        border: 1px solid #e9ecef;
        transition: all 0.3s ease;
    }

        .presentation-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

    .profile-subsection {
        padding: 12px;
        border-radius: 6px;
        background: white;
        margin-bottom: 12px;
        border-left: 3px solid #0073aa;
    }

    .professor-image-container {
        text-align: center;
    }

    .professor-image {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #0073aa;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .professor-placeholder {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: #f8f9fa;
        border: 3px solid #dee2e6;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #6c757d;
        font-size: 2em;
    }

    .detail-item-sm {
        margin-bottom: 12px;
        padding: 8px 12px;
        border-radius: 4px;
        background-color: #f8f9fa;
        border-left: 2px solid #0073aa;
    }

        .detail-item-sm .detail-label {
            font-weight: 600;
            color: #2c3338;
            margin-bottom: 3px;
            font-size: 0.85em;
        }

        .detail-item-sm .detail-value {
            color: #50575e;
            font-size: 0.9em;
        }

    .member-card {
        transition: all 0.3s ease;
        border: 1px solid #e1e1e1;
    }

        .member-card:hover {
            border-color: #0073aa;
            box-shadow: 0 4px 12px rgba(0,115,170,0.1);
            transform: translateY(-2px);
        }

    /* ProfessorModel Grid Layout Style */
    .professor-card-compact {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        transition: all 0.3s ease;
        background: white;
        height: 100%;
    }

        .professor-card-compact:hover {
            border-color: #0073aa;
            box-shadow: 0 2px 8px rgba(0,115,170,0.1);
            transform: translateY(-1px);
        }

    .professor-image-compact {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #0073aa;
    }

    .professor-placeholder-compact {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #f8f9fa;
        border: 2px solid #dee2e6;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #6c757d;
        font-size: 1.2em;
    }

    .professor-info {
        font-size: 0.85em;
    }

    .badge-sm {
        font-size: 0.7em;
        padding: 3px 6px;
    }

    /* Option 2: Horizontal Cards Styles */
    .professors-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 12px;
    }

    .professor-card-horizontal {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px;
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        background: white;
        transition: all 0.3s ease;
    }

        .professor-card-horizontal:hover {
            border-color: #0073aa;
            box-shadow: 0 2px 6px rgba(0,115,170,0.1);
        }

    .professor-header {
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
    }

    .professor-image-tiny {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #0073aa;
    }

    .professor-placeholder-tiny {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #f8f9fa;
        border: 2px solid #dee2e6;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #6c757d;
        font-size: 1em;
    }

    .professor-title {
        flex: 1;
    }

        .professor-title strong {
            font-size: 0.9em;
            color: #0073aa;
        }

    .professor-details {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .professor-meta {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 2px;
    }

    .badge-xs {
        font-size: 0.65em;
        padding: 2px 5px;
    }

    .email-link, .scholar-link {
        color: #6c757d;
        text-decoration: none;
        padding: 4px;
        border-radius: 3px;
        transition: all 0.2s;
    }

        .email-link:hover {
            color: #0073aa;
            background: #e3f2fd;
        }

        .scholar-link:hover {
            color: #ff6f00;
            background: #fff3e0;
        }

    /* StudentModel Compact Card Styles */
    .student-card-compact {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        transition: all 0.3s ease;
        background: white;
        height: 100%;
    }

        .student-card-compact:hover {
            border-color: #17a2b8;
            box-shadow: 0 2px 8px rgba(23,162,184,0.1);
            transform: translateY(-1px);
        }

    .student-image-compact {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #17a2b8;
    }

    .student-placeholder-compact {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #f8f9fa;
        border: 2px solid #dee2e6;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #6c757d;
        font-size: 1.2em;
    }

    .student-info {
        font-size: 0.85em;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }

    .student-card-compact .flex-grow-1 {
        min-width: 0; /* This allows text to wrap properly */
    }

    .student-card-compact .student-info span,
    .student-card-compact .student-info a {
        word-break: break-word;
        overflow-wrap: break-word;
    }

    .bg-linkedin {
        background-color: #0a66c2 !important;
    }

    /* Consistent button styles for both professor and student cards */
    .btn-sm {
        padding: 0.25rem 0.5rem !important;
        font-size: 0.75rem !important;
        line-height: 1.5 !important;
        border-radius: 0.2rem !important;
    }

    .btn-outline-primary {
        color: #0073aa !important;
        border-color: #0073aa !important;
        background-color: transparent !important;
    }

        .btn-outline-primary:hover {
            color: #fff !important;
            background-color: #0073aa !important;
            border-color: #0073aa !important;
        }

    .btn-outline-info {
        color: #17a2b8 !important;
        border-color: #17a2b8 !important;
        background-color: transparent !important;
    }

        .btn-outline-info:hover {
            color: #fff !important;
            background-color: #17a2b8 !important;
            border-color: #17a2b8 !important;
        }

    /* Ensure consistent button sizing and spacing */
    .details-button-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 8px;
    }

    .badges-container {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
    }

    /* Custom button styles to ensure perfect consistency */
    .custom-details-button {
        display: inline-flex;
        align-items: center;
        padding: 3px 8px;
        font-size: 0.75rem;
        line-height: 1.5;
        border-radius: 0.2rem;
        border: 1px solid;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.15s ease-in-out;
        gap: 4px;
    }

    .custom-details-button-primary {
        color: #0073aa;
        border-color: #0073aa;
        background-color: transparent;
    }

        .custom-details-button-primary:hover {
            color: #fff;
            background-color: #0073aa;
            border-color: #0073aa;
        }

    .custom-details-button-info {
        color: #17a2b8;
        border-color: #17a2b8;
        background-color: transparent;
    }

        .custom-details-button-info:hover {
            color: #fff;
            background-color: #17a2b8;
            border-color: #17a2b8;
        }

    /* Pagination Styles */
    .pagination-item {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 32px;
        height: 32px;
        padding: 0 8px;
        margin: 0 2px;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        background-color: white;
        color: #0073aa;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
        user-select: none;
    }

        .pagination-item:hover:not(.disabled) {
            background-color: #e9ecef;
            border-color: #0073aa;
        }

        .pagination-item.active {
            background-color: #0073aa;
            border-color: #0073aa;
            color: white;
        }

        .pagination-item.disabled {
            color: #6c757d;
            background-color: #f8f9fa;
            border-color: #dee2e6;
            cursor: not-allowed;
            opacity: 0.6;
        }

    .pagination-ellipsis {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 32px;
        height: 32px;
        padding: 0 8px;
        margin: 0 2px;
        color: #6c757d;
        font-size: 0.875rem;
    }

    /* Project Compact Card Styles */
    .project-card-compact {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        transition: all 0.3s ease;
        background: white;
        height: 100%;
    }

        .project-card-compact:hover {
            border-color: #ffc107;
            box-shadow: 0 2px 8px rgba(255,193,7,0.1);
            transform: translateY(-1px);
        }

    .project-title {
        font-size: 0.9em;
        line-height: 1.3;
    }

    .project-info {
        font-size: 0.8em;
    }

    /* Custom warning button style */
    .custom-details-button-warning {
        color: #ffc107;
        border-color: #ffc107;
        background-color: transparent;
    }

        .custom-details-button-warning:hover {
            color: #212529;
            background-color: #ffc107;
            border-color: #ffc107;
        }

    .custom-select-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
    }

    .custom-select {
        width: 100%;
        cursor: pointer;
    }

    .custom-arrow {
        position: absolute;
        top: 50%;
        right: 10px;
        transform: translateY(-50%);
        pointer-events: none;
        color: #6c757d;
        font-size: 0.8em;
    }

    /* Remove default arrow in IE */
    .custom-select::-ms-expand {
        display: none;
    }

    /* Patent Compact Card Styles */
    .patent-card-compact {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        transition: all 0.3s ease;
        background: white;
        height: 100%;
    }

        .patent-card-compact:hover {
            border-color: #28a745;
            box-shadow: 0 2px 8px rgba(40,167,69,0.1);
            transform: translateY(-1px);
        }

    .patent-title {
        font-size: 0.9em;
        line-height: 1.3;
    }

    .patent-info {
        font-size: 0.8em;
    }

    /* Custom success button style */
    .custom-details-button-success {
        color: #28a745;
        border-color: #28a745;
        background-color: transparent;
    }

        .custom-details-button-success:hover {
            color: #fff;
            background-color: #28a745;
            border-color: #28a745;
        }
</style>

<div class="research-group-container">
    <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
            @onclick="NavigateBack"
            onmouseover="this.style.backgroundColor='#4a5568'"
            onmouseout="this.style.backgroundColor='#2d3748'">
        <i class="fas fa-times me-2"></i> Κλείσιμο
    </button>
    @if (isLoading)
    {
        <div class="text-center mt-5">
            <div class="loading-spinner" style="width: 40px; height: 40px; border-width: 4px;"></div>
            <p class="mt-3">Φόρτωση στοιχείων ερευνητικής ομάδας...</p>
        </div>
    }
    else if (researchGroup == null)
    {
        <div class="info-card text-center">
            <h3 style="color: #d63638;">Δεν βρέθηκε η ερευνητική ομάδα</h3>
            <p>Η ερευνητική ομάδα που ζητήσατε δεν βρέθηκε ή δεν έχετε δικαίωμα πρόσβασης.</p>
            <button class="wp-button" @onclick="NavigateBack">
                <i class="fas fa-times me-2"></i>Κλείσιμο
            </button>
        </div>
    }
    else
    {
        <br/>
        <br />
        <!-- Header Section -->
        <div class="header-section position-relative" style="min-height: 320px;">
            <!-- YouTube Background Video -->
            @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroup_EmbeddedPromoVideo))
            {
                <div class="video-background" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 1;">
                    <!-- Dark overlay for better text readability -->
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); z-index: 2;"></div>

                    <!-- YouTube iframe with autoplay -->
                    @{
                        var videoId = ExtractYouTubeId(researchGroup.ResearchGroup_EmbeddedPromoVideo);
                        var embedUrl = $"https://www.youtube.com/embed/{videoId}?autoplay=1&mute=1&loop=1&playlist={videoId}&controls=0&showinfo=0&rel=0&modestbranding=1&disablekb=1&playsinline=1";
                    }
                    <iframe src="@embedUrl"
                            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); min-width: 100%; min-height: 100%; width: auto; height: auto;"
                            frameborder="0"
                            allow="autoplay; encrypted-media; picture-in-picture"
                            allowfullscreen>
                    </iframe>
                </div>
            }

            <!-- Main content with higher z-index -->
            <div style="position: relative; z-index: 3;">
                <div class="row align-items-center h-100">
                    <!-- Logo - Moved more left with negative margin -->
                    <div class="col-md-2 text-center" style="margin-left: -20px;">
                        @if (researchGroup?.ResearchGroupImage != null && researchGroup.ResearchGroupImage.Length > 0)
                        {
                            <div class="logo-container">
                                <img src="data:image/jpeg;base64,@Convert.ToBase64String(researchGroup.ResearchGroupImage)"
                                     alt="Λογότυπο" class="research-group-logo" />
                            </div>
                        }
                        else
                        {
                            <div class="logo-container">
                                <div style="width: 180px; height: 180px; background: rgba(255,255,255,0.2); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-university" style="font-size: 3em; color: rgba(255,255,255,0.7);"></i>
                                </div>
                            </div>
                        }
                    </div>

                    <!-- Content Area -->
                    <div class="col-md-10">
                        <h1 class="display-5 mb-2">@(researchGroup?.ResearchGroupName ?? "Άγνωστο Όνομα")</h1>
                        @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupAcronym))
                        {
                            <p class="lead mb-3" style="font-size: 1.3em; opacity: 0.9;">(@researchGroup.ResearchGroupAcronym)</p>
                        }
                        <div class="row">
                            <div class="col-md-6">
                                <p class="mb-2">
                                    <i class="fas fa-university me-2"></i>@(researchGroup?.ResearchGroupUniversity ?? "Δεν δηλώθηκε")
                                </p>
                                <p class="mb-2">
                                    <i class="fas fa-map-marker-alt me-2"></i>
                                    @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupPostalAddress) && researchGroup.ResearchGroupPostalAddress != "Δεν δηλώθηκε")
                                    {
                                        <a href="@GetGoogleMapsUrl(researchGroup.ResearchGroupPostalAddress)"
                                           target="_blank"
                                           style="color: inherit; text-decoration: underline; cursor: pointer;"
                                           title="Ανοιγμή στο Google Maps">
                                            @researchGroup.ResearchGroupPostalAddress
                                        </a>
                                    }
                                    else
                                    {
                                        @(researchGroup?.ResearchGroupPostalAddress ?? "Δεν δηλώθηκε")
                                    }
                                </p>
                            </div>
                            <!-- Contact Info with Social Networks and Attachment -->
                            <div class="col-md-6">
                                <p class="mb-2">
                                    <i class="fas fa-envelope me-2"></i>@(researchGroup?.ResearchGroupContactEmail ?? "Δεν δηλώθηκε")
                                </p>
                                <p class="mb-2">
                                    <i class="fas fa-phone me-2"></i>@(researchGroup?.ResearchGroupTelephoneNumber ?? "Δεν δηλώθηκε")
                                </p>

                                <!-- Social Networks - Under Telephone -->
                                <div class="social-networks-inline mt-2 mb-2">
                                    <div class="d-flex align-items-center gap-2">
                                        <span style="color: rgba(255,255,255,0.9); font-size: 0.95em;">Κοινωνικά Δίκτυα:</span>
                                        <div class="d-flex gap-1">
                                            @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroup_Website))
                                            {
                                                <a href="@researchGroup.ResearchGroup_Website" target="_blank" class="social-icon website" title="Ιστότοπος" style="width: 28px; height: 28px;">
                                                    <i class="fas fa-globe" style="font-size: 0.8em;"></i>
                                                </a>
                                            }
                                            @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroup_Facebook))
                                            {
                                                <a href="@researchGroup.ResearchGroup_Facebook" target="_blank" class="social-icon facebook" title="Facebook" style="width: 28px; height: 28px;">
                                                    <i class="fab fa-facebook-f" style="font-size: 0.8em;"></i>
                                                </a>
                                            }
                                            @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroup_Twitter))
                                            {
                                                <a href="@researchGroup.ResearchGroup_Twitter" target="_blank" class="social-icon twitter" title="Twitter" style="width: 28px; height: 28px;">
                                                    <i class="fab fa-twitter" style="font-size: 0.8em;"></i>
                                                </a>
                                            }
                                            @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroup_LinkedIn))
                                            {
                                                <a href="@researchGroup.ResearchGroup_LinkedIn" target="_blank" class="social-icon linkedin" title="LinkedIn" style="width: 28px; height: 28px;">
                                                    <i class="fab fa-linkedin-in" style="font-size: 0.8em;"></i>
                                                </a>
                                            }
                                            @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroup_YouTubeChannel))
                                            {
                                                <a href="@researchGroup.ResearchGroup_YouTubeChannel" target="_blank" class="social-icon youtube" title="YouTube" style="width: 28px; height: 28px;">
                                                    <i class="fab fa-youtube" style="font-size: 0.8em;"></i>
                                                </a>
                                            }
                                        </div>
                                    </div>
                                </div>
                                <br />
                                <!-- Presentation Attachment - Under Social Networks -->
                                @if (researchGroup?.ResearchGroup_PresentationAttachment != null && researchGroup.ResearchGroup_PresentationAttachment.Length > 0)
                                {
                                    <div class="presentation-attachment-header">
                                        <p class="mb-0">
                                            <i class="fas fa-file-pdf me-2" style="color: #ff6b6b;"></i>
                                            <span style="color: rgba(255,255,255,0.9);">Συνημμένο Αρχείο Ομάδας: </span>
                                            <a href="data:application/pdf;base64,@Convert.ToBase64String(researchGroup.ResearchGroup_PresentationAttachment)"
                                               download="Presentation_@(researchGroup.ResearchGroupName ?? "ResearchGroup").pdf"
                                               class="modern-button"
                                               style="background-color: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 3px; padding: 3px 8px; text-decoration: none; transition: all 0.2s; font-size: 0.9em; margin-left: 8px;"
                                               onmouseover="this.style.backgroundColor='rgba(255,255,255,0.3)'; this.style.borderColor='rgba(255,255,255,0.5)'"
                                               onmouseout="this.style.backgroundColor='rgba(255,255,255,0.2)'; this.style.borderColor='rgba(255,255,255,0.3)'">
                                                <i class="fas fa-download me-1"></i>Λήψη
                                            </a>
                                        </p>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>


        <div class="stats-grid">
            <div class="stat-item" @onclick='() => NavigateToSection("announcements")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@announcements.Count</span>
                <span class="stat-label">Ανακοινώσεις</span>
            </div>
            <div class="stat-item" @onclick='() => NavigateToSection("professors")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@professors.Count</span>
                <span class="stat-label">Μέλη ΔΕΠ</span>
            </div>
            <div class="stat-item" @onclick='() => NavigateToSection("students")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@students.Count</span>
                <span class="stat-label">Συνεργάτες</span>
            </div>
            <div class="stat-item" @onclick='() => NavigateToSection("projects")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@projects.Count</span>
                <span class="stat-label">Ερευνητικές Δράσεις</span>
            </div>
            <div class="stat-item" @onclick='() => NavigateToSection("publications")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@publications.Count</span>
                <span class="stat-label">Δημοσιεύσεις</span>
            </div>
            <div class="stat-item" @onclick='() => NavigateToSection("patents")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@patents.Count</span>
                <span class="stat-label">Πατέντες</span>
            </div>
            <div class="stat-item" @onclick='() => NavigateToSection("ipodomes")' style="cursor: pointer; border-left-color: #2d3748;">
                <span class="stat-number" style="color: #2d3748;">@ipodomes.Count</span>
                <span class="stat-label">Υποδομές</span>
            </div>
        </div>

        <!-- Basic Information - Expandable -->
        <div class="info-card">
            <div class="expandable-section">
                <div class="section-header" @onclick='() => ToggleSection("basicInfo")'>
                    <h3 class="section-title-expandable">
                        <i class="fas fa-info-circle"></i>Βασικές Πληροφορίες
                    </h3>
                    <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("basicInfo") ? "chevron-rotated" : "")"></i>
                </div>
                @if (expandedSections.Contains("basicInfo"))
                {
                    <div class="section-content">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <div class="detail-label">Μοναδικό ID</div>
                                    <div class="detail-value">@(researchGroup?.ResearchGroup_UniqueID ?? "Δεν δηλώθηκε")</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Ημερομηνία Ίδρυσης</div>
                                    <div class="detail-value">@(researchGroup?.ResearchGroup_DateOfCreation.ToString("dd/MM/yyyy") ?? "Δεν δηλώθηκε")</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Σχολή</div>
                                    <div class="detail-value">@(researchGroup?.ResearchGroupSchool ?? "Δεν δηλώθηκε")</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <div class="detail-label">Τμήμα</div>
                                    <div class="detail-value">@(researchGroup?.ResearchGroupUniversityDepartment ?? "Δεν δηλώθηκε")</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Εργαστήριο</div>
                                    <div class="detail-value">@(researchGroup?.ResearchGroupLab ?? "Δεν δηλώθηκε")</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">ΦΕΚ</div>
                                    <div class="detail-value">@(researchGroup?.ResearchGroupFEK ?? "Δεν δηλώθηκε")</div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>

        @if (announcements?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("announcements")' id="announcements">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-bullhorn" style="color: #0073aa;"></i> Ανακοινώσεις (@announcements.Count)
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("announcements") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("announcements"))
                    {
                        <div class="section-content">
                            @{
                                var pageItems = GetPaginatedAnnouncements().ToList();
                                var count = pageItems.Count;
                                // If 5 items, midPoint is 3. Left gets 3, Right gets 2.
                                var midPoint = (int)Math.Ceiling(count / 2.0);
                                var leftColumnItems = pageItems.Take(midPoint).ToList();
                                var rightColumnItems = pageItems.Skip(midPoint).ToList();
                            }

                            <div class="row">
                                <div class="col-lg-6 col-md-6 mb-3">
                                    @foreach (var announcement in leftColumnItems)
                                    {
                                        <div class="project-card-compact mb-3" style="border-left: 4px solid #0073aa; transition: all 0.3s ease;">
                                            <div class="d-flex flex-column p-3">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <h6 class="project-title" style="color: #0073aa; margin-bottom: 0; flex: 1;">
                                                        @(announcement.ResearchGroupAnnouncementTitle ?? "Χωρίς Τίτλο")
                                                    </h6>
                                                    <span class="badge ms-2" style="background-color: #0073aa; font-size: 0.7em;">
                                                        @announcement.ResearchGroupAnnouncementUploadDate.ToString("dd/MM/yyyy")
                                                    </span>
                                                </div>

                                                <div class="project-info mb-2">
                                                    <p class="text-muted small mb-0" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                                        @announcement.ResearchGroupAnnouncementDescription
                                                    </p>
                                                </div>

                                                <div class="d-flex justify-content-between align-items-center mt-auto pt-2 border-top">
                                                    <small class="text-muted" style="font-size: 0.75em;">
                                                        <i class="far fa-clock me-1"></i>
                                                        Λήξη: @announcement.ResearchGroupAnnouncementTimeToBeActive.ToString("dd/MM/yyyy")
                                                    </small>
                                                    <button class="custom-details-button"
                                                            style="color: #0073aa; border-color: #0073aa; background: transparent;"
                                                            onmouseover="this.style.backgroundColor='#0073aa'; this.style.color='white';"
                                                            onmouseout="this.style.backgroundColor='transparent'; this.style.color='#0073aa';"
                                                            @onclick="() => ShowAnnouncementDetails(announcement)">
                                                        <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>

                                <div class="col-lg-6 col-md-6 mb-3">
                                    @foreach (var announcement in rightColumnItems)
                                    {
                                        <div class="project-card-compact mb-3" style="border-left: 4px solid #0073aa; transition: all 0.3s ease;">
                                            <div class="d-flex flex-column p-3">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <h6 class="project-title" style="color: #0073aa; margin-bottom: 0; flex: 1;">
                                                        @(announcement.ResearchGroupAnnouncementTitle ?? "Χωρίς Τίτλο")
                                                    </h6>
                                                    <span class="badge ms-2" style="background-color: #0073aa; font-size: 0.7em;">
                                                        @announcement.ResearchGroupAnnouncementUploadDate.ToString("dd/MM/yyyy")
                                                    </span>
                                                </div>

                                                <div class="project-info mb-2">
                                                    <p class="text-muted small mb-0" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                                        @announcement.ResearchGroupAnnouncementDescription
                                                    </p>
                                                </div>

                                                <div class="d-flex justify-content-between align-items-center mt-auto pt-2 border-top">
                                                    <small class="text-muted" style="font-size: 0.75em;">
                                                        <i class="far fa-clock me-1"></i>
                                                        Λήξη: @announcement.ResearchGroupAnnouncementTimeToBeActive.ToString("dd/MM/yyyy")
                                                    </small>
                                                    <button class="custom-details-button"
                                                            style="color: #0073aa; border-color: #0073aa; background: transparent;"
                                                            onmouseover="this.style.backgroundColor='#0073aa'; this.style.color='white';"
                                                            onmouseout="this.style.backgroundColor='transparent'; this.style.color='#0073aa';"
                                                            @onclick="() => ShowAnnouncementDetails(announcement)">
                                                        <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>

                            @if (announcements.Any())
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <span class="pagination-item @(currentPageAnnouncements == 1 ? "disabled" : "")"
                                          @onclick="GoToFirstPageAnnouncements">
                                        &lt;&lt;
                                    </span>

                                    <span class="pagination-item @(currentPageAnnouncements == 1 ? "disabled" : "")"
                                          @onclick="PreviousPageAnnouncements">
                                        &lt;
                                    </span>

                                    @foreach (var pageNumber in GetVisiblePagesAnnouncements())
                                    {
                                        if (pageNumber == -1)
                                        {
                                            <span class="pagination-ellipsis">...</span>
                                        }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPageAnnouncements ? "active" : "")"
                                                  @onclick="() => GoToPageAnnouncements(pageNumber)">
                                                @pageNumber
                                            </span>
                                        }
                                    }

                                    <span class="pagination-item @(currentPageAnnouncements == totalPagesAnnouncements ? "disabled" : "")"
                                          @onclick="NextPageAnnouncements">
                                        &gt;
                                    </span>

                                    <span class="pagination-item @(currentPageAnnouncements == totalPagesAnnouncements ? "disabled" : "")"
                                          @onclick="GoToLastPageAnnouncements">
                                        &gt;&gt;
                                    </span>

                                    <span class="ms-3 small text-muted">Σελίδα @currentPageAnnouncements από @totalPagesAnnouncements</span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }
        <!-- Research Materials - Compact Two-Column Layout -->
        @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupAreas) ||
       !string.IsNullOrEmpty(researchGroup?.ResearchGroupSkills) ||
       !string.IsNullOrEmpty(researchGroup?.ResearchGroupKeywords) ||
       (researchGroup?.ResearchGroup_PresentationAttachment != null && researchGroup.ResearchGroup_PresentationAttachment.Length > 0))
       {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("researchMaterials")'>
                        <h3 class="section-title-expandable">
                            <i class="fas fa-folder-open"></i>Τεχνολογίες & Περιοχές Ενδιαφέροντος Ομάδας
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("researchMaterials") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("researchMaterials"))
                    {
                        <div class="section-content">
                            <div class="row">
                                <!-- Research Profile Column -->
                                @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupAreas) ||
                               !string.IsNullOrEmpty(researchGroup?.ResearchGroupSkills) ||
                               !string.IsNullOrEmpty(researchGroup?.ResearchGroupKeywords))
                                {
                                    <div class="col-md-8">
                                        <h5 style="color: #2d3748; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-chart-line"></i>
                                            Ερευνητικό Προφίλ
                                        </h5>

                                        <!-- Research Areas -->
                                        @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupAreas))
                                        {
                                            <div class="profile-subsection mb-3">
                                                <h6 style="color: #2d3748; margin-bottom: 10px; display: flex; align-items: center; gap: 6px;">
                                                    <i class="fas fa-search" style="font-size: 0.8em;"></i>
                                                    Ερευνητικές Περιοχές
                                                </h6>
                                                <div class="d-flex flex-wrap gap-1">
                                                    @foreach (var area in (researchGroup.ResearchGroupAreas ?? "").Split(','))
                                                    {
                                                        if (!string.IsNullOrWhiteSpace(area))
                                                        {
                                                            <span class="badge badge-custom bg-primary" style="font-size: 0.75em;">@area.Trim()</span>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        }

                                        <!-- Technologies -->
                                        @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupSkills))
                                        {
                                            <div class="profile-subsection mb-3">
                                                <h6 style="color: #2d3748; margin-bottom: 10px; display: flex; align-items: center; gap: 6px;">
                                                    <i class="fas fa-cogs" style="font-size: 0.8em;"></i>
                                                    Τεχνολογίες
                                                </h6>
                                                <div class="d-flex flex-wrap gap-1">
                                                    @foreach (var tech in (researchGroup.ResearchGroupSkills ?? "").Split(','))
                                                    {
                                                        if (!string.IsNullOrWhiteSpace(tech))
                                                        {
                                                            <span class="badge badge-custom bg-success" style="font-size: 0.75em;">@tech.Trim()</span>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        }

                                        <!-- Keywords -->
                                        @if (!string.IsNullOrEmpty(researchGroup?.ResearchGroupKeywords))
                                        {
                                            <div class="profile-subsection">
                                                <h6 style="color: #2d3748; margin-bottom: 10px; display: flex; align-items: center; gap: 6px;">
                                                    <i class="fas fa-key" style="font-size: 0.8em;"></i>
                                                    Λέξεις Κλειδιά
                                                </h6>
                                                <div class="d-flex flex-wrap gap-1">
                                                    @foreach (var keyword in (researchGroup.ResearchGroupKeywords ?? "").Split(','))
                                                    {
                                                        if (!string.IsNullOrWhiteSpace(keyword))
                                                        {
                                                            <span class="badge badge-custom bg-secondary" style="font-size: 0.75em;">@keyword.Trim()</span>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        }
                                    </div>
                                }

                                
                            </div>
                        </div>
                    }
                </div>
            </div>
       }

        <!-- Professors - Compact Grid Layout -->
        @if (professorDetails?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("professors")' id="professors">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-user-tie"></i>Μέλη ΔΕΠ (@professorDetails.Count)
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("professors") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("professors"))
                    {
                        <div class="section-content">
                            <div class="row">
                                @foreach (var professor in GetPaginatedProfessors())
                                {
                                    <div class="col-lg-6 col-xl-4 mb-3">
                                        <div class="professor-card-compact">
                                            <div class="d-flex align-items-start gap-3 p-3">
                                                <!-- ProfessorModel Image -->
                                                <div class="flex-shrink-0">
                                                    @if (professor?.ProfImage != null && professor.ProfImage.Length > 0)
                                                    {
                                                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(professor.ProfImage)"
                                                             alt="@professor.Name @professor.Surname"
                                                             class="professor-image-compact" />
                                                    }
                                                    else
                                                    {
                                                        <div class="professor-placeholder-compact">
                                                            <i class="fas fa-user-tie"></i>
                                                        </div>
                                                    }
                                                </div>

                                                <!-- ProfessorModel Details -->
                                                <div class="flex-grow-1">
                                                    <h6 class="professor-name" style="color: #0073aa; margin-bottom: 8px;">
                                                        @professor?.Name @professor?.Surname
                                                    </h6>

                                                    <div class="professor-info">
                                                        <div class="mb-1">
                                                            <small class="text-muted">Ρόλος:</small>
                                                            <span class="ms-1">@professor?.Role</span>
                                                        </div>
                                                        <div class="mb-1">
                                                            <small class="text-muted">Βαθμίδα:</small>
                                                            <span class="ms-1">@professor?.Vathmida</span>
                                                        </div>
                                                        <div class="mb-1">
                                                            <small class="text-muted">Τμήμα:</small>
                                                            <span class="ms-1">@professor?.Department</span>
                                                        </div>
                                                        @if (!string.IsNullOrEmpty(professor?.Email))
                                                        {
                                                            <div class="mb-1">
                                                                <small class="text-muted">Email:</small>
                                                                <a href="mailto:@professor.Email" class="ms-1" style="color: #0073aa; font-size: 0.85em;">@professor.Email</a>
                                                            </div>
                                                        }
                                                    </div>

                                                    <!-- View Details Button -->
                                                    <div class="details-button-container">
                                                        <div class="badges-container">
                                                            <span class="badge bg-primary badge-sm">ΔΕΠ</span>
                                                            @if (!string.IsNullOrEmpty(professor?.GoogleScholarProfile))
                                                            {
                                                                <a href="@professor.GoogleScholarProfile" target="_blank" class="badge bg-warning text-dark badge-sm" title="Google Scholar">
                                                                    <i class="fab fa-google me-1"></i>Scholar
                                                                </a>
                                                            }
                                                        </div>
                                                        <button class="custom-details-button custom-details-button-primary"
                                                                @onclick='() => ShowProfessorDetails(professor)'
                                                                title="Προβολή Λεπτομερειών">
                                                            <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>

                            <!-- Pagination Controls for Professors -->
                            @if (professorDetails?.Any() == true)
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <!-- First Page (<<) -->
                                    <span class="pagination-item @(currentPageProfessors == 1 ? "disabled" : "")"
                                          @onclick="GoToFirstPageProfessors">
                                        &lt;&lt;
                                    </span>

                                    <!-- Previous Page (<) -->
                                    <span class="pagination-item @(currentPageProfessors == 1 ? "disabled" : "")"
                                          @onclick="PreviousPageProfessors">
                                        &lt;
                                    </span>

                                    <!-- Page Numbers -->
                                    @foreach (var pageNumber in GetVisiblePagesProfessors())
                                    {
                                        if (pageNumber == -1)
                                        {
                                            <span class="pagination-ellipsis">...</span>
                                        }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPageProfessors ? "active" : "")"
                                                  @onclick="() => GoToPageProfessors(pageNumber)">
                                                @pageNumber
                                            </span>
                                        }
                                    }

                                    <!-- Next Page (>) -->
                                    <span class="pagination-item @(currentPageProfessors == totalPagesProfessors ? "disabled" : "")"
                                          @onclick="NextPageProfessors">
                                        &gt;
                                    </span>

                                    <!-- Last Page (>>) -->
                                    <span class="pagination-item @(currentPageProfessors == totalPagesProfessors ? "disabled" : "")"
                                          @onclick="GoToLastPageProfessors">
                                        &gt;&gt;
                                    </span>

                                    <span class="ms-3 small text-muted">Σελίδα @currentPageProfessors από @totalPagesProfessors</span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }
        <!-- ProfessorModel Details Modal -->
        @if (showProfessorModal && selectedProfessor != null)
        {
            <div class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0, 0, 0, 0.5);">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content" style="border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                        <div class="modal-header" style="border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0; background-color: #f8f9fa;">
                            <h5 class="modal-title" style="color: #4682B4; font-weight: 600; font-size: 1.25rem;">
                                @selectedProfessor.Name @selectedProfessor.Surname
                            </h5>
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    @onclick="CloseProfessorModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <span style="font-size: 1.2rem; line-height: 1;">×</span>
                            </button>
                        </div>
                        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                            <!-- Profile Picture -->
                            <div class="text-center mb-4">
                                @if (selectedProfessor.ProfImage != null && selectedProfessor.ProfImage.Length > 0)
                                {
                                    <img src="data:image/jpeg;base64,@Convert.ToBase64String(selectedProfessor.ProfImage)"
                                         alt="Φωτογραφία Προφίλ Καθηγητή"
                                         style="max-width: 150px; max-height: 150px; border-radius: 50%; object-fit: cover; border: 3px solid #ddd;" />
                                }
                                else
                                {
                                    <div style="width: 150px; height: 150px; border-radius: 50%; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; margin: 0 auto; border: 3px solid #ddd;">
                                        <i class="fas fa-user-tie" style="font-size: 3rem; color: #6c757d;"></i>
                                    </div>
                                    <p style="color: #6c757d; margin-top: 8px;">Δεν υπάρχει φωτογραφία Προφίλ</p>
                                }
                            </div>

                            <!-- ProfessorModel Email -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Email</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-envelope mr-2 text-primary"></i>
                                    <span>@selectedProfessor.Email</span>
                                </div>
                            </div>

                            <!-- ProfessorModel University and Department -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Πανεπιστήμιο</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-university mr-2 text-primary"></i>
                                    <span>@selectedProfessorFullDetails?.ProfUniversity</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Τμήμα</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-building mr-2"></i>
                                    <span>@selectedProfessorFullDetails?.ProfDepartment</span>
                                </div>
                            </div>

                            <!-- ProfessorModel Vahmida Department -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Βαθμίδα ΔΕΠ</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-user-tie mr-2"></i>
                                    <span>@selectedProfessor.Vathmida</span>
                                </div>
                            </div>

                            <!-- ProfessorModel Role in Research Group -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Ρόλος στην Ερευνητική Ομάδα</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-users mr-2 text-info"></i>
                                    <span>@selectedProfessor.Role</span>
                                </div>
                            </div>

                            <!-- ProfessorModel Work and Personal Telephone -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Τηλέφωνο Εργασίας</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-phone mr-2 text-success"></i>
                                    <span>@selectedProfessorFullDetails?.ProfWorkTelephone</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Προσωπικό Τηλέφωνο</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-phone mr-2 text-success"></i>
                                    @if (selectedProfessorFullDetails?.ProfPersonalTelephoneVisibility == true && !string.IsNullOrEmpty(selectedProfessorFullDetails.ProfPersonalTelephone))
                                    {
                                        <span>@selectedProfessorFullDetails.ProfPersonalTelephone</span>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν Διατίθεται</span>
                                    }
                                </div>
                            </div>

                            <!-- ProfessorModel Personal Website -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Ιστότοπος</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-globe mr-2 text-info"></i>
                                    @if (!string.IsNullOrWhiteSpace(selectedProfessorFullDetails?.ProfPersonalWebsite))
                                    {
                                        <a href="@selectedProfessorFullDetails.ProfPersonalWebsite" target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedProfessorFullDetails.ProfPersonalWebsite
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν Διατίθεται</span>
                                    }
                                </div>
                            </div>

                            <!-- ProfessorModel LinkedIn Site -->
                            <div class="form-group">
                                <label style="font-weight: bold;">LinkedIn</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fab fa-linkedin mr-2" style="color: #0077b5;"></i>
                                    @if (!string.IsNullOrWhiteSpace(selectedProfessorFullDetails?.ProfLinkedInSite))
                                    {
                                        <a href="@selectedProfessorFullDetails.ProfLinkedInSite" target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedProfessorFullDetails.ProfLinkedInSite
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν Διατίθεται</span>
                                    }
                                </div>
                            </div>

                            <!-- ProfessorModel Scholar Profile -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Scholar Profile</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-graduation-cap mr-2" style="color: #4285F4;"></i>
                                    @if (!string.IsNullOrWhiteSpace(selectedProfessor.GoogleScholarProfile))
                                    {
                                        <a href="@selectedProfessor.GoogleScholarProfile" target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedProfessor.GoogleScholarProfile
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν Διατίθεται</span>
                                    }
                                </div>
                            </div>

                            <!-- ProfessorModel ORCID Profile -->
                            <div class="form-group">
                                <label style="font-weight: bold;">ORCID Profile</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-id-card mr-2" style="color: #A6CE39;"></i>
                                    @if (!string.IsNullOrWhiteSpace(selectedProfessorFullDetails?.ProfOrchidProfile))
                                    {
                                        <a href="@selectedProfessorFullDetails.ProfOrchidProfile" target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedProfessorFullDetails.ProfOrchidProfile
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν Διατίθεται</span>
                                    }
                                </div>
                            </div>

                            <!-- ProfessorModel General Field of Work (Areas) -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Γενικός Τομέας Εργασίας</label>
                                <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="3">@selectedProfessorFullDetails?.ProfGeneralFieldOfWork</textarea>
                            </div>

                            <!-- ProfessorModel General Skills -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Γενικές Δεξιότητες</label>
                                <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="3">@selectedProfessorFullDetails?.ProfGeneralSkills</textarea>
                            </div>

                            <!-- ProfessorModel Personal Description -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Προσωπική Περιγραφή</label>
                                <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="4">@selectedProfessorFullDetails?.ProfPersonalDescription</textarea>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
                                    @onclick="CloseProfessorModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <i class="fas fa-arrow-left me-2"></i> Κλείσιμο
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }

        @if (showAnnouncementModal && selectedAnnouncement != null)
        {
            <div class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0, 0, 0, 0.5);">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content" style="border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                        <div class="modal-header" style="border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0; background-color: #f8f9fa;">
                            <h5 class="modal-title" style="color: #4682B4; font-weight: 600; font-size: 1.25rem;">
                                @selectedAnnouncement.ResearchGroupAnnouncementTitle
                            </h5>
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    @onclick="CloseAnnouncementModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <span style="font-size: 1.2rem; line-height: 1;">×</span>
                            </button>
                        </div>
                        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                            <div class="text-center mb-4">
                                <div style="width: 150px; height: 150px; border-radius: 50%; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; margin: 0 auto; border: 3px solid #ddd;">
                                    <i class="fas fa-bullhorn" style="font-size: 3rem; color: #6c757d;"></i>
                                </div>
                                <p style="color: #6c757d; margin-top: 8px;">Ανακοίνωση</p>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Ημερομηνία Ανάρτησης</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-calendar-plus mr-2 text-primary"></i>
                                    <span>@selectedAnnouncement.ResearchGroupAnnouncementUploadDate.ToString("dd/MM/yyyy")</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Λήξη Ανακοίνωσης</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-hourglass-end mr-2 text-danger"></i>
                                    <span> @selectedAnnouncement.ResearchGroupAnnouncementTimeToBeActive.ToString("dd/MM/yyyy")</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Κατάσταση</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-info-circle mr-2 text-info"></i>
                                    <span> @selectedAnnouncement.ResearchGroupAnnouncementStatus</span>
                                </div>
                            </div>

                            @if (!string.IsNullOrEmpty(selectedAnnouncement.ResearchGroupAnnouncementDescription))
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">Περιγραφή</label>
                                    <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="6">@selectedAnnouncement.ResearchGroupAnnouncementDescription</textarea>
                                </div>
                            }

                            @if (selectedAnnouncement.ResearchGroupAnnouncementAttachmentFile != null && selectedAnnouncement.ResearchGroupAnnouncementAttachmentFile.Length > 0)
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">Συνημμένο Αρχείο</label>
                                    <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                        <i class="fas fa-file-download mr-2 text-success"></i>
                                        <a href="data:application/pdf;base64,@Convert.ToBase64String(selectedAnnouncement.ResearchGroupAnnouncementAttachmentFile)"
                                           download= "Announcement_@(selectedAnnouncement.Id).pdf"
                                           class="text-primary text-decoration-underline"
                                           style="font-weight: 500;">
                                            Λήψη Αρχείου
                                        </a>
                                    </div>
                                </div>
                            }
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
                                    @onclick="CloseAnnouncementModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <i class="fas fa-arrow-left me-2"></i> Κλείσιμο
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- Students - Compact Grid Layout -->
        @if (studentDetails?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("students")' id="students">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-user-graduate"></i>Συνεργάτες (@studentDetails.Count)
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("students") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("students"))
                    {
                        <div class="section-content">
                            <div class="row">
                                @foreach (var student in GetPaginatedStudents())
                                {
                                    <div class="col-lg-6 col-xl-4 mb-3">
                                        <div class="student-card-compact">
                                            <div class="d-flex align-items-start gap-3 p-3">
                                                <!-- StudentModel Image -->
                                                <div class="flex-shrink-0">
                                                    @if (student?.Image != null && student.Image.Length > 0)
                                                    {
                                                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(student.Image)"
                                                             alt="@student.Name @student.Surname"
                                                             class="student-image-compact" />
                                                    }
                                                    else
                                                    {
                                                        <div class="student-placeholder-compact">
                                                            <i class="fas fa-user-graduate"></i>
                                                        </div>
                                                    }
                                                </div>

                                                <!-- StudentModel Details -->
                                                <div class="flex-grow-1">
                                                    <h6 class="student-name" style="color: #0073aa; margin-bottom: 8px;">
                                                        @student?.Name @student?.Surname
                                                    </h6>

                                                    <div class="student-info">
                                                        <div class="mb-1">
                                                            <small class="text-muted">Επίπεδο Σπουδών:</small>
                                                            <span class="ms-1">@student?.LevelOfStudies</span>
                                                        </div>
                                                        <div class="mb-1">
                                                            <small class="text-muted">Τμήμα:</small>
                                                            <span class="ms-1">@student?.Department</span>
                                                        </div>
                                                        @if (!string.IsNullOrEmpty(student?.Email))
                                                        {
                                                            <div class="mb-1">
                                                                <small class="text-muted">Email:</small>
                                                                <a href="mailto:@student.Email" class="ms-1" style="color: #0073aa; font-size: 0.85em;">@student.Email</a>
                                                            </div>
                                                        }
                                                    </div>

                                                    <!-- View Details Button -->
                                                    <div class="details-button-container">
                                                        <div class="badges-container">
                                                            <span class="badge bg-info badge-sm">Συνεργάτης</span>
                                                            @if (!string.IsNullOrEmpty(student?.PersonalWebsite))
                                                            {
                                                                <a href="@student.PersonalWebsite" target="_blank" class="badge bg-linkedin text-white badge-sm" title="LinkedIn Profile">
                                                                    <i class="fab fa-linkedin me-1"></i>LinkedIn
                                                                </a>
                                                            }
                                                        </div>
                                                        <button class="custom-details-button custom-details-button-info"
                                                                @onclick='() => ShowStudentDetails(student)'
                                                                title="Προβολή Λεπτομερειών">
                                                            <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>

                            <!-- Pagination Controls for Students -->
                            @if (studentDetails?.Any() == true)
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <!-- First Page (<<) -->
                                    <span class="pagination-item @(currentPageStudents == 1 ? "disabled" : "")"
                                          @onclick="GoToFirstPageStudents">
                                        &lt;&lt;
                                    </span>

                                    <!-- Previous Page (<) -->
                                    <span class="pagination-item @(currentPageStudents == 1 ? "disabled" : "")"
                                          @onclick="PreviousPageStudents">
                                        &lt;
                                    </span>

                                    <!-- Page Numbers -->
                                    @foreach (var pageNumber in GetVisiblePagesStudents())
                                    {
                                        if (pageNumber == -1)
                                        {
                                            <span class="pagination-ellipsis">...</span>
                                        }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPageStudents ? "active" : "")"
                                                  @onclick="() => GoToPageStudents(pageNumber)">
                                                @pageNumber
                                            </span>
                                        }
                                    }

                                    <!-- Next Page (>) -->
                                    <span class="pagination-item @(currentPageStudents == totalPagesStudents ? "disabled" : "")"
                                          @onclick="NextPageStudents">
                                        &gt;
                                    </span>

                                    <!-- Last Page (>>) -->
                                    <span class="pagination-item @(currentPageStudents == totalPagesStudents ? "disabled" : "")"
                                          @onclick="GoToLastPageStudents">
                                        &gt;&gt;
                                    </span>

                                    <span class="ms-3 small text-muted">Σελίδα @currentPageStudents από @totalPagesStudents</span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }

        <!-- STUDENT DETAILS MODAL -->
        @if (showStudentModal && selectedStudent != null)
        {
            <div class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0, 0, 0, 0.5);">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content" style="border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                        <div class="modal-header" style="border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0; background-color: #f8f9fa;">
                            <h5 class="modal-title" style="color: #4682B4; font-weight: 600; font-size: 1.25rem;">
                                @selectedStudent.Name @selectedStudent.Surname
                            </h5>
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    @onclick="CloseStudentModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <span style="font-size: 1.2rem; line-height: 1;">×</span>
                            </button>
                        </div>
                        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                            <!-- Profile Picture -->
                            <div class="text-center mb-4">
                                @if (selectedStudent.Image != null && selectedStudent.Image.Length > 0)
                                {
                                    var base64Image = Convert.ToBase64String(selectedStudent.Image);
                                    <img src="data:image/jpeg;base64,@base64Image"
                                         alt="Φωτογραφία Προφίλ Σπουδαστή"
                                         style="max-width: 150px; max-height: 150px; border-radius: 50%; object-fit: cover; border: 3px solid #ddd;" />
                                }
                                else
                                {
                                    <div style="width: 150px; height: 150px; border-radius: 50%; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; margin: 0 auto; border: 3px solid #ddd;">
                                        <i class="fas fa-user" style="font-size: 3rem; color: #6c757d;"></i>
                                    </div>
                                    <p style="color: #6c757d; margin-top: 8px;">Δεν υπάρχει φωτογραφία Προφίλ</p>
                                }
                            </div>

                            <!-- StudentModel Details -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Αριθμός Μητρώου</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-id-card mr-2"></i>
                                    <span>@selectedStudentFullDetails?.RegNumber</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Κατηγορία Σπουδών</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-graduation-cap mr-2"></i>
                                    <span>@selectedStudent.LevelOfStudies</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Πανεπιστήμιο</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-university mr-2 text-primary"></i>
                                    <span>@selectedStudent.University</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Τμήμα</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-building mr-2"></i>
                                    <span>@selectedStudent.Department</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Έτος Σπουδών</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-calendar-alt mr-2"></i>
                                    <span>@selectedStudentFullDetails?.StudyYear</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Ημερομηνία Εγγραφής</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-calendar-day mr-2"></i>
                                    <span>@selectedStudent.RegistrationDate.ToString("dd/MM/yyyy")</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Επικοινωνία</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-envelope mr-2 text-primary"></i>
                                    <span>@selectedStudent.Email</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Τηλέφωνο</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-phone mr-2 text-success"></i>
                                    <span>@(selectedStudentFullDetails?.PhoneVisibility == true ? selectedStudentFullDetails.Telephone : "N/A")</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Κατάσταση Πρακτικής</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-briefcase mr-2"></i>
                                    <span>@selectedStudentFullDetails?.InternshipStatus</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Κατάσταση Διπλωματικής</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-file-alt mr-2"></i>
                                    <span>@selectedStudentFullDetails?.ThesisStatus</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Περιοχές Ενδιαφέροντος</label>
                                <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="3">@selectedStudentFullDetails?.AreasOfExpertise</textarea>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Εξειδίκευση</label>
                                <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="3">@selectedStudentFullDetails?.Keywords</textarea>
                            </div>

                            <!-- Address Section -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Περιφέρεια (Μόνιμης Διαμονής)</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-map mr-2"></i>
                                    <span>@selectedStudentFullDetails?.PermanentRegion</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Πόλη (Μόνιμης Διαμονής)</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-city mr-2"></i>
                                    <span>@selectedStudentFullDetails?.PermanentTown</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Διεύθυνση</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-map-marker-alt mr-2 text-danger"></i>
                                    @if (!string.IsNullOrEmpty(selectedStudentFullDetails?.PermanentAddress))
                                    {
                                        <a href="https://www.google.com/maps/search/?api=1&query=@Uri.EscapeDataString(selectedStudentFullDetails.PermanentAddress)"
                                           target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedStudentFullDetails.PermanentAddress
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν έχει οριστεί διεύθυνση</span>
                                    }
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Διαθέτει Μέσο Μεταφοράς</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-car mr-2" style="color: @(selectedStudentFullDetails?.Transport == true ? "#28a745" : "#dc3545");"></i>
                                    <span style="color: @(selectedStudentFullDetails?.Transport == true ? "#28a745" : "#dc3545"); font-weight: 500;">
                                        @(selectedStudentFullDetails?.Transport == true ? "Ναι" : "Όχι")
                                    </span>
                                </div>
                            </div>

                            <!-- Social Links -->
                            <div class="form-group">
                                <label style="font-weight: bold;">LinkedIn Προφίλ</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fab fa-linkedin mr-2 text-primary"></i>
                                    @if (!string.IsNullOrEmpty(selectedStudent.PersonalWebsite))
                                    {
                                        <a href="@selectedStudent.PersonalWebsite" target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedStudent.PersonalWebsite
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν έχει οριστεί προφίλ LinkedIn ακόμη..</span>
                                    }
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Προσωπική Ιστοσελίδα</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-globe mr-2 text-info"></i>
                                    @if (!string.IsNullOrEmpty(selectedStudentFullDetails?.PersonalWebsite))
                                    {
                                        <a href="@selectedStudentFullDetails.PersonalWebsite" target="_blank"
                                           class="text-primary text-decoration-underline">
                                            @selectedStudentFullDetails.PersonalWebsite
                                        </a>
                                    }
                                    else
                                    {
                                        <span style="color: #6c757d;">Δεν έχει οριστεί ιστοσελίδα ακόμη..</span>
                                    }
                                </div>
                            </div>

                            <!-- Role in Research Group -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Ρόλος στην Ερευνητική Ομάδα</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-users mr-2 text-info"></i>
                                    <span>@selectedStudent.Role</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
                                    @onclick="CloseStudentModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <i class="fas fa-arrow-left me-2"></i> Κλείσιμο
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }



        <!-- Research Actions (Projects) - Compact Grid Layout -->
        @if (projects?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("projects")' id="projects">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-flask"></i>Ερευνητικές Δράσεις (@filteredProjects.Count())
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("projects") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("projects"))
                    {
                        <div class="section-content">
                            <!-- Filter Dropdown - Same width as cards with dropdown arrow -->
                            <div class="row mb-3">
                                <!-- First card column - Filter -->
                                <div class="col-12 mb-3">
                                    <div class="project-card-compact" style="background-color: #e9ecef;">
                                        <div class="d-flex flex-column h-100 p-3">
                                            <div class="form-group mb-0">
                                                <label style="font-weight: bold; margin-bottom: 8px; font-size: 0.9em;">Φίλτρο Κατάστασης:</label>
                                                <div class="custom-select-wrapper">
                                                    <select class="form-control form-control-sm custom-select"
                                                            @bind="projectStatusFilter"
                                                            @bind:event="onchange"
                                                            style="border-radius: 4px; border: 1px solid #ddd; padding: 6px 8px; font-size: 0.85em; appearance: none; -webkit-appearance: none; -moz-appearance: none; background: white; padding-right: 30px;">
                                                        <option value="all">Όλες οι Καταστάσεις</option>
                                                        <option value="OnGoing">Εν Ενεργεία</option>
                                                        <option value="Past">Ολοκληρωμένες</option>
                                                    </select>
                                                    <div class="custom-arrow">
                                                        <i class="fas fa-chevron-down"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="text-muted mt-2" style="font-size: 0.8em;">
                                                @if (projectStatusFilter == "all")
                                                {
                                                    <span>Όλες οι δράσεις (@filteredProjects.Count())</span>
                                                }
                                                else if (projectStatusFilter == "OnGoing")
                                                {
                                                    <span>Ενεργές δράσεις (@filteredProjects.Count())</span>
                                                }
                                                else
                                                {
                                                    <span>Ολοκληρωμένες δράσεις (@filteredProjects.Count())</span>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                @foreach (var project in GetPaginatedProjects())
                                {
                                    <div class="col-lg-6 col-xl-4 mb-3">
                                        <div class="project-card-compact">
                                            <div class="d-flex flex-column h-100 p-3">
                                                <!-- Project Header -->
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <h6 class="project-title" style="color: #0073aa; margin-bottom: 0; flex: 1;">
                                                        @(project?.ResearchGroup.ProjectTitle ?? "Άγνωστος Τίτλος")
                                                    </h6>
                                                    <span class="badge @((project?.ResearchGroup.ProjectStatus == "OnGoing" ? "bg-success" : "bg-secondary")) ms-2 badge-sm">
                                                        @((project?.ResearchGroup.ProjectStatus == "OnGoing" ? "Εν Ενεργεία" : "Ολοκληρωμένο"))
                                                    </span>
                                                </div>

                                                <!-- Project Basic Info -->
                                                <div class="project-info flex-grow-1">
                                                    <div class="mb-1">
                                                        <small class="text-muted">Agreement Number:</small>
                                                        <span class="ms-1">@(project?.ResearchGroup.ProjectGrantAgreementNumber ?? "Δεν δηλώθηκε")</span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <small class="text-muted">Συντομογραφία:</small>
                                                        <span class="ms-1">@(project?.ResearchGroup.ProjectAcronym ?? "Δεν δηλώθηκε")</span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <small class="text-muted">Πλαίσιο:</small>
                                                        <span class="ms-1">@(project?.ResearchGroup.ProjectFramework ?? "Δεν δηλώθηκε")</span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <small class="text-muted">Περίοδος:</small>
                                                        <span class="ms-1">
                                                            @(project?.ResearchGroup.ProjectStartDate?.ToString("dd/MM/yyyy") ?? "Δεν δηλώθηκε") -
                                                            @(project?.ResearchGroup.ProjectEndDate?.ToString("dd/MM/yyyy") ?? "Δεν δηλώθηκε")
                                                        </span>
                                                    </div>
                                                </div>

                                                <!-- View Details Button -->
                                                <div class="details-button-container mt-2">
                                                    <div class="badges-container">
                                                        <span class="badge bg-warning text-dark badge-sm">Ερευνητική Δράση</span>
                                                        @if (!string.IsNullOrEmpty(project?.ResearchGroup.ProjectWebsite))
                                                        {
                                                            <a href="@project.ResearchGroup.ProjectWebsite" target="_blank" class="badge bg-primary text-white badge-sm" title="Ιστότοπος Έργου">
                                                                <i class="fas fa-globe me-1"></i>Ιστότοπος
                                                            </a>
                                                        }
                                                    </div>
                                                    <button class="custom-details-button custom-details-button-warning"
                                                            @onclick="@(() => ShowProjectDetails(project))"
                                                            title="Προβολή Λεπτομερειών">
                                                        <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>

                            <!-- No Results Message -->
                            @if (!filteredProjects.Any())
                            {
                                <div class="text-center py-4">
                                    <i class="fas fa-search" style="font-size: 3rem; color: #6c757d; margin-bottom: 1rem;"></i>
                                    <h5 style="color: #6c757d;">Δεν βρέθηκαν ερευνητικές δράσεις</h5>
                                    <p class="text-muted">Δεν υπάρχουν ερευνητικές δράσεις που να ταιριάζουν με τα κριτήρια φιλτραρίσματος.</p>
                                </div>
                            }

                            <!-- Pagination Controls for Projects -->
                            @if (filteredProjects.Any())
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <!-- First Page (<<) -->
                                    <span class="pagination-item @(currentPageProjects == 1 ? "disabled" : "")"
                                          @onclick="@(() => GoToFirstPageProjects())">
                                        &lt;&lt;
                                    </span>

                                    <!-- Previous Page (<) -->
                                    <span class="pagination-item @(currentPageProjects == 1 ? "disabled" : "")"
                                          @onclick="@(() => PreviousPageProjects())">
                                        &lt;
                                    </span>

                                    <!-- Page Numbers -->
                                    @foreach (var pageNumber in GetVisiblePagesProjects())
                                    {
                                        if (pageNumber == -1)
                                        {
                                            <span class="pagination-ellipsis">...</span>
                                        }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPageProjects ? "active" : "")"
                                                  @onclick="@(() => GoToPageProjects(pageNumber))">
                                                @pageNumber
                                            </span>
                                        }
                                    }

                                    <!-- Next Page (>) -->
                                    <span class="pagination-item @(currentPageProjects == totalPagesProjects ? "disabled" : "")"
                                          @onclick="@(() => NextPageProjects())">
                                        &gt;
                                    </span>

                                    <!-- Last Page (>>) -->
                                    <span class="pagination-item @(currentPageProjects == totalPagesProjects ? "disabled" : "")"
                                          @onclick="@(() => GoToLastPageProjects())">
                                        &gt;&gt;
                                    </span>

                                    <span class="ms-3 small text-muted">Σελίδα @currentPageProjects από @totalPagesProjects</span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }
        <!-- Project Details Modal -->
        @if (showProjectModal && selectedProject != null)
        {
            <div class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0, 0, 0, 0.5);">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content" style="border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                        <div class="modal-header" style="border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0; background-color: #f8f9fa;">
                            <h5 class="modal-title" style="color: #4682B4; font-weight: 600; font-size: 1.25rem;">
                                @selectedProject.ResearchGroup.ProjectTitle
                            </h5>
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    @onclick="CloseProjectModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <span style="font-size: 1.2rem; line-height: 1;">×</span>
                            </button>
                        </div>
                        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                            <!-- Project Icon -->
                            <div class="text-center mb-4">
                                <div style="width: 150px; height: 150px; border-radius: 50%; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; margin: 0 auto; border: 3px solid #ddd;">
                                    <i class="fas fa-flask" style="font-size: 3rem; color: #6c757d;"></i>
                                </div>
                                <p style="color: #6c757d; margin-top: 8px;">Ερευνητική Δράση</p>
                            </div>

                            <!-- Project Status -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Κατάσταση Έργου</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-chart-line mr-2 @(selectedProject.ResearchGroup.ProjectStatus == "OnGoing" ? "text-success" : "text-secondary")"></i>
                                    <span>@(selectedProject.ResearchGroup.ProjectStatus == "OnGoing" ? "Εν Ενεργεία" : "Ολοκληρωμένο")</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Αριθμός Σύμβασης</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-file-contract mr-2 text-primary"></i>
                                    <span>@selectedProject.ResearchGroup.ProjectGrantAgreementNumber</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Συντομογραφία</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-abacus mr-2 text-info"></i>
                                    <span>@selectedProject.ResearchGroup.ProjectAcronym</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Πλαίσιο</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-layer-group mr-2 text-info"></i>
                                    <span>@selectedProject.ResearchGroup.ProjectFramework</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Επιστημονικός Υπεύθυνος</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-user-tie mr-2 text-primary"></i>
                                    <span>@selectedProject.ResearchGroup.ProjectScientificResponsibleEmail</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Προϋπολογισμός Ομάδας</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-euro-sign mr-2 text-success"></i>
                                    <span>@selectedProject.ResearchGroup.OurProjectBudget</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Κωδικός ΕΛΚΕ</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-code mr-2 text-info"></i>
                                    <span>@selectedProject.ResearchGroup.ProjectELKECode</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Περίοδος</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-calendar-alt mr-2 text-info"></i>
                                    <span>
                                        @selectedProject.ResearchGroup.ProjectStartDate?.ToString("dd/MM/yyyy") -
                                        @selectedProject.ResearchGroup.ProjectEndDate?.ToString("dd/MM/yyyy")
                                    </span>
                                </div>
                            </div>

                            @if (!string.IsNullOrEmpty(selectedProject.ResearchGroup.ProjectWebsite))
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">Ιστότοπος</label>
                                    <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                        <i class="fas fa-globe mr-2 text-primary"></i>
                                        <a href="@selectedProject.ResearchGroup.ProjectWebsite" target="_blank" class="text-primary text-decoration-underline">
                                            @selectedProject.ResearchGroup.ProjectWebsite
                                        </a>
                                    </div>
                                </div>
                            }

                            @if (!string.IsNullOrEmpty(selectedProject.ResearchGroup.ProjectDescription))
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">Περιγραφή Έργου</label>
                                    <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="6">@selectedProject.ResearchGroup.ProjectDescription</textarea>
                                </div>
                            }
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
                                    @onclick="CloseProjectModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <i class="fas fa-arrow-left me-2"></i> Κλείσιμο
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- Publications - Expandable -->
        @if (publications?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("publications")' id="publications">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-book"></i>Δημοσιεύσεις (@publications.Count)
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("publications") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("publications"))
                    {
                        <div class="section-content">
                            <!-- Publications Per Page Dropdown -->
                            <div class="row mb-3">
                                <div class="col-12">
                                    <div class="form-group mb-0">
                                        <label style="font-weight: bold; margin-bottom: 8px; font-size: 0.9em;">Δημοσιεύσεις ανά σελίδα:</label>
                                        <div class="custom-select-wrapper">
                                            <select class="form-control form-control-sm custom-select"
                                                    @bind="publicationsPerPage"
                                                    @bind:event="onchange"
                                                    style="border-radius: 4px; border: 1px solid #ddd; padding: 6px 8px; font-size: 0.85em; appearance: none; -webkit-appearance: none; -moz-appearance: none; background: white; padding-right: 30px;">
                                                    <option value="5">5</option>
                                                    <option value="10">10</option>
                                                    <option value="50">50</option>
                                                    <option value="100">100</option>
                                            </select>
                                            <div class="custom-arrow">
                                                <i class="fas fa-chevron-down"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 d-flex align-items-end">
                                    <div class="text-muted small">
                                        <span>Σελίδα @currentPublicationsPage από @totalPublicationsPages - Σύνολο: @publications.Count δημοσιεύσεις</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Publications List -->
                            @foreach (var publication in GetPaginatedPublications())
                            {
                                <div class="publication-card">
                                    <h6 style="color: #0073aa;">
                                        @if (!string.IsNullOrEmpty(publication?.PK_ResearchGroupMemberPublication_Url))
                                        {
                                            var cleanUrl = System.Net.WebUtility.HtmlDecode(publication.PK_ResearchGroupMemberPublication_Url);
                                            cleanUrl = cleanUrl.Replace("&amp;", "&");
                                            <a href="@cleanUrl" target="_blank" style="color: inherit; text-decoration: none;" rel="noopener noreferrer">
                                                @(publication?.PK_ResearchGroupMemberPublication_Title ?? "Άγνωστος Τίτλος")
                                            </a>
                                        }
                                        else
                                        {
                                            @(publication?.PK_ResearchGroupMemberPublication_Title ?? "Άγνωστος Τίτλος")
                                        }
                                    </h6>
                                    <p class="mb-2 small text-muted">@(publication?.PK_ResearchGroupMemberPublication_Authors ?? "Δεν δηλώθηκαν συγγραφείς")</p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">@(publication?.PK_ResearchGroupMemberPublication_Journal ?? "Δεν δηλώθηκε")</small>
                                        <div class="d-flex align-items-center gap-2">
                                            <small class="text-muted">@(publication?.PK_ResearchGroupMemberPublication_Year ?? "Δεν δηλώθηκε")</small>
                                            @if (!string.IsNullOrEmpty(publication?.PK_ResearchGroupMemberPublication_CitedBy))
                                            {
                                                <span class="badge bg-info">
                                                    <i class="fas fa-quote-right"></i> @publication.PK_ResearchGroupMemberPublication_CitedBy citations
                                                </span>
                                            }
                                        </div>
                                    </div>
                                </div>
                            }

                            <!-- Pagination Controls -->
                            @if (totalPublicationsPages > 1)
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <!-- First Page (<<) -->
                                    <span class="pagination-item @(currentPublicationsPage == 1 ? "disabled" : "")"
                                          @onclick="@(() => GoToFirstPagePublications())">
                                        &lt;&lt;
                                    </span>

                                    <!-- Previous Page (<) -->
                                    <span class="pagination-item @(currentPublicationsPage == 1 ? "disabled" : "")"
                                          @onclick="@(() => PreviousPagePublications())">
                                        &lt;
                                    </span>

                                    <!-- Page Numbers -->
                                    @foreach (var pageNumber in GetVisiblePagesPublications())
                                    {
                                        if (pageNumber == -1)
                                        {
                                            <span class="pagination-ellipsis">...</span>
                                        }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPublicationsPage ? "active" : "")"
                                                  @onclick="@(() => GoToPagePublications(pageNumber))">
                                                @pageNumber
                                            </span>
                                        }
                                    }

                                    <!-- Next Page (>) -->
                                    <span class="pagination-item @(currentPublicationsPage == totalPublicationsPages ? "disabled" : "")"
                                          @onclick="@(() => NextPagePublications())">
                                        &gt;
                                    </span>

                                    <!-- Last Page (>>) -->
                                    <span class="pagination-item @(currentPublicationsPage == totalPublicationsPages ? "disabled" : "")"
                                          @onclick="@(() => GoToLastPagePublications())">
                                        &gt;&gt;
                                    </span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }

        <!-- Patents - Compact Grid Layout -->
        @if (patents?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("patents")' id="patents">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-lightbulb"></i>Πατέντες (@filteredPatents.Count())
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("patents") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("patents"))
                    {
                        <div class="section-content">
                            <!-- Filter Dropdown - Same width as cards with dropdown arrow -->
                            <div class="row mb-3">
                                <!-- First card column - Filter -->
                                <div class="col-12 mb-3">
                                    <div class="patent-card-compact" style="background-color: #e9ecef;">
                                        <div class="d-flex flex-column h-100 p-3">
                                            <div class="form-group mb-0">
                                                <label style="font-weight: bold; margin-bottom: 8px; font-size: 0.9em;">Φίλτρο Κατάστασης:</label>
                                                <div class="custom-select-wrapper">
                                                    <select class="form-control form-control-sm custom-select"
                                                            @bind="patentStatusFilter"
                                                            @bind:event="onchange"
                                                            style="border-radius: 4px; border: 1px solid #ddd; padding: 6px 8px; font-size: 0.85em; appearance: none; -webkit-appearance: none; -moz-appearance: none; background: white; padding-right: 30px;">
                                                        <option value="all">Όλες οι Καταστάσεις</option>
                                                        <option value="Ενεργή">Ενεργές</option>
                                                        <option value="Ανενεργή">Ανενεργές</option>
                                                    </select>
                                                    <div class="custom-arrow">
                                                        <i class="fas fa-chevron-down"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="text-muted mt-2" style="font-size: 0.8em;">
                                                @if (patentStatusFilter == "all")
                                                {
                                                    <span>Όλες οι πατέντες (@filteredPatents.Count())</span>
                                                }
                                                else if (patentStatusFilter == "Ενεργή")
                                                {
                                                    <span>Ενεργές πατέντες (@filteredPatents.Count())</span>
                                                }
                                                else
                                                {
                                                    <span>Ανενεργές πατέντες (@filteredPatents.Count())</span>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                @foreach (var patent in GetPaginatedPatents())
                                {
                                    <div class="col-lg-6 col-xl-4 mb-3">
                                        <div class="patent-card-compact">
                                            <div class="d-flex flex-column h-100 p-3">
                                                <!-- Patent Header -->
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <h6 class="patent-title" style="color: #0073aa; margin-bottom: 0; flex: 1;">
                                                        @(patent?.ResearchGroup.Patent_PatentTitle ?? "Άγνωστος Τίτλος")
                                                    </h6>
                                                    <span class="badge @((patent?.ResearchGroup.Patent_PatentStatus == "Ενεργή" ? "bg-success" : "bg-secondary")) ms-2 badge-sm">
                                                        @(patent?.ResearchGroup.Patent_PatentStatus ?? "Δεν δηλώθηκε")
                                                    </span>
                                                </div>

                                                <!-- Patent Basic Info -->
                                                <div class="patent-info flex-grow-1">
                                                    <div class="mb-1">
                                                        <small class="text-muted">Τύπος:</small>
                                                        <span class="ms-1">@(patent?.ResearchGroup.Patent_PatentType ?? "Δεν δηλώθηκε")</span>
                                                    </div>
                                                    <div class="mb-1">
                                                        <small class="text-muted">DOI:</small>
                                                        <span class="ms-1">@(patent?.ResearchGroup.Patent_PatentDOI ?? "Δεν δηλώθηκε")</span>
                                                    </div>
                                                    @if (!string.IsNullOrEmpty(patent?.ResearchGroup.Patent_PatentURL))
                                                    {
                                                        <div class="mb-1">
                                                            <small class="text-muted">URL:</small>
                                                            <a href="@patent.ResearchGroup.Patent_PatentURL" target="_blank" class="ms-1" style="color: #0073aa; font-size: 0.85em;">Προβολή</a>
                                                        </div>
                                                    }
                                                </div>

                                                <!-- View Details Button -->
                                                <div class="details-button-container mt-2">
                                                    <div class="badges-container">
                                                        <span class="badge bg-success badge-sm">Πατέντα</span>
                                                        @if (!string.IsNullOrEmpty(patent?.ResearchGroup.Patent_PatentURL))
                                                        {
                                                            <a href="@patent.ResearchGroup.Patent_PatentURL" target="_blank" class="badge bg-primary text-white badge-sm" title="Προβολή Πατέντας">
                                                                <i class="fas fa-external-link-alt me-1"></i>Προβολή
                                                            </a>
                                                        }
                                                    </div>
                                                    <button class="custom-details-button custom-details-button-success"
                                                            @onclick="@(() => ShowPatentDetails(patent))"
                                                            title="Προβολή Λεπτομερειών">
                                                        <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>

                            <!-- No Results Message -->
                            @if (!filteredPatents.Any())
                            {
                                <div class="text-center py-4">
                                    <i class="fas fa-search" style="font-size: 3rem; color: #6c757d; margin-bottom: 1rem;"></i>
                                    <h5 style="color: #6c757d;">Δεν βρέθηκαν πατέντες</h5>
                                    <p class="text-muted">Δεν υπάρχουν πατέντες που να ταιριάζουν με τα κριτήρια φιλτραρίσματος.</p>
                                </div>
                            }

                            <!-- Pagination Controls for Patents -->
                            @if (filteredPatents.Any())
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <!-- First Page (<<) -->
                                    <span class="pagination-item @(currentPagePatents == 1 ? "disabled" : "")"
                                          @onclick="@(() => GoToFirstPagePatents())">
                                        &lt;&lt;
                                    </span>

                                    <!-- Previous Page (<) -->
                                    <span class="pagination-item @(currentPagePatents == 1 ? "disabled" : "")"
                                          @onclick="@(() => PreviousPagePatents())">
                                        &lt;
                                    </span>

                                    <!-- Page Numbers -->
                                    @foreach (var pageNumber in GetVisiblePagesPatents())
                                    {
                                        if (pageNumber == -1)
                                        {
                                            <span class="pagination-ellipsis">...</span>
                                        }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPagePatents ? "active" : "")"
                                                  @onclick="@(() => GoToPagePatents(pageNumber))">
                                                @pageNumber
                                            </span>
                                        }
                                    }

                                    <!-- Next Page (>) -->
                                    <span class="pagination-item @(currentPagePatents == totalPagesPatents ? "disabled" : "")"
                                          @onclick="@(() => NextPagePatents())">
                                        &gt;
                                    </span>

                                    <!-- Last Page (>>) -->
                                    <span class="pagination-item @(currentPagePatents == totalPagesPatents ? "disabled" : "")"
                                          @onclick="@(() => GoToLastPagePatents())">
                                        &gt;&gt;
                                    </span>

                                    <span class="ms-3 small text-muted">Σελίδα @currentPagePatents από @totalPagesPatents</span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }

        @if (showIpodomeModal && selectedIpodome != null)
        {
            <div class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0, 0, 0, 0.5);">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content" style="border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                        <div class="modal-header" style="border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0; background-color: #f8f9fa;">
                            <h5 class="modal-title" style="color: #2d3748; font-weight: 600; font-size: 1.25rem;">
                                <i class="fas fa-server me-2" style="color: #6f42c1;"></i> @selectedIpodome.ResearchGroup_Ipodomes_Title
                            </h5>
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    @onclick="CloseIpodomeModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <span style="font-size: 1.2rem; line-height: 1;">×</span>
                            </button>
                        </div>
                        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                            @if (selectedIpodome.ResearchGroup_Ipodomes_Images != null && selectedIpodome.ResearchGroup_Ipodomes_Images.Length > 0)
                            {
                                <div class="text-center mb-4">
                                    <img src="data:image/jpeg;base64,@Convert.ToBase64String(selectedIpodome.ResearchGroup_Ipodomes_Images)"
                                         class="img-fluid rounded"
                                         style="max-height: 300px; border: 1px solid #dee2e6;"
                                         alt="Εικόνα Υποδομής" />
                                </div>
                            }

                            <div class="form-group mb-3">
                                <label style="font-weight: bold;">Περιγραφή</label>
                                <div class="p-3" style="border-radius: 8px; background-color: #f8f9fa; border: 1px solid #e9ecef;">
                                    @selectedIpodome.ResearchGroup_Ipodomes_Description
                                </div>
                            </div>

                            @if (!string.IsNullOrEmpty(selectedIpodome.ResearchGroup_Ipodomes_Keywords))
                            {
                                <div class="form-group mb-3">
                                    <label style="font-weight: bold;">Λέξεις Κλειδιά</label>
                                    <div class="d-flex flex-wrap gap-2 mt-2">
                                        @foreach (var tag in selectedIpodome.ResearchGroup_Ipodomes_Keywords.Split(','))
                                        {
                                            <span class="badge bg-secondary p-2">@tag.Trim()</span>
                                        }
                                    </div>
                                </div>
                            }

                            @if (selectedIpodome.ResearchGroup_Ipodomes_Attachment != null && selectedIpodome.ResearchGroup_Ipodomes_Attachment.Length > 0)
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">Συνημμένο Αρχείο</label>
                                    <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                        <i class="fas fa-file-download mr-2 text-success"></i>
                                        <a href="data:application/pdf;base64,@Convert.ToBase64String(selectedIpodome.ResearchGroup_Ipodomes_Attachment)"
                                           download="Infrastructure_@(selectedIpodome.Id).pdf"
                                           class="text-primary text-decoration-underline"
                                           style="font-weight: 500;">
                                            Λήψη Αρχείου
                                        </a>
                                    </div>
                                </div>
                            }
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
                                    @onclick="CloseIpodomeModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <i class="fas fa-arrow-left me-2"></i> Κλείσιμο
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- Patent Details Modal -->
        @if (showPatentModal && selectedPatent != null)
        {
            <div class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0, 0, 0, 0.5);">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content" style="border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                        <div class="modal-header" style="border-bottom: 1px solid #e9ecef; border-radius: 12px 12px 0 0; background-color: #f8f9fa;">
                            <h5 class="modal-title" style="color: #4682B4; font-weight: 600; font-size: 1.25rem;">
                                @selectedPatent.ResearchGroup.Patent_PatentTitle
                            </h5>
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s;"
                                    @onclick="ClosePatentModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <span style="font-size: 1.2rem; line-height: 1;">×</span>
                            </button>
                        </div>
                        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                            <!-- Patent Icon -->
                            <div class="text-center mb-4">
                                <div style="width: 150px; height: 150px; border-radius: 50%; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; margin: 0 auto; border: 3px solid #ddd;">
                                    <i class="fas fa-lightbulb" style="font-size: 3rem; color: #6c757d;"></i>
                                </div>
                                <p style="color: #6c757d; margin-top: 8px;">Πατέντα</p>
                            </div>

                            <!-- Patent Status -->
                            <div class="form-group">
                                <label style="font-weight: bold;">Κατάσταση Πατέντας</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-chart-line mr-2 @(selectedPatent.ResearchGroup.Patent_PatentStatus == "Ενεργή" ? "text-success" : "text-secondary")"></i>
                                    <span>@selectedPatent.ResearchGroup.Patent_PatentStatus</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">Τύπος Πατέντας</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-copyright mr-2 text-primary"></i>
                                    <span>@selectedPatent.ResearchGroup.Patent_PatentType</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: bold;">DOI</label>
                                <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                    <i class="fas fa-fingerprint mr-2 text-info"></i>
                                    <span>@selectedPatent.ResearchGroup.Patent_PatentDOI</span>
                                </div>
                            </div>

                            @if (!string.IsNullOrEmpty(selectedPatent.ResearchGroup.Patent_PatentURL))
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">URL Πατέντας</label>
                                    <div class="form-control d-flex align-items-center" style="border-radius: 8px; background-color: #f8f9fa;">
                                        <i class="fas fa-external-link-alt mr-2 text-primary"></i>
                                        <a href="@selectedPatent.ResearchGroup.Patent_PatentURL" target="_blank" class="text-primary text-decoration-underline">
                                            @selectedPatent.ResearchGroup.Patent_PatentURL
                                        </a>
                                    </div>
                                </div>
                            }

                            @if (!string.IsNullOrEmpty(selectedPatent.ResearchGroup.Patent_PatentDescription))
                            {
                                <div class="form-group">
                                    <label style="font-weight: bold;">Περιγραφή Πατέντας</label>
                                    <textarea class="form-control" style="border-radius: 8px; background-color: #f8f9fa;" readonly rows="6">@selectedPatent.ResearchGroup.Patent_PatentDescription</textarea>
                                </div>
                            }
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modern-button" style="background-color: #2d3748; color: white; border: none; border-radius: 6px; padding: 8px 20px; transition: all 0.2s;"
                                    @onclick="ClosePatentModal"
                                    onmouseover="this.style.backgroundColor='#4a5568'"
                                    onmouseout="this.style.backgroundColor='#2d3748'">
                                <i class="fas fa-arrow-left me-2"></i> Κλείσιμο
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- Spin-Off Companies - Compact Grid Layout -->
        @if (spinOffCompanies?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("spinOffs")'>
                        <h3 class="section-title-expandable">
                            <i class="fas fa-building"></i>Εταιρείες Spin-Off (@spinOffCompanies.Count)
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("spinOffs") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("spinOffs"))
                    {
                        <div class="section-content">
                            <div class="row">
                                @foreach (var company in spinOffCompanies)
                                {
                                    <div class="col-lg-6 col-xl-4 mb-3">
                                        <div class="project-card-compact" style="background-color: #e9ecef;">
                                            <div class="d-flex flex-column h-100 p-3">
                                                <!-- CompanyModel Header -->
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <h6 class="project-title" style="color: #0073aa; margin-bottom: 0; flex: 1;">
                                                        @(company?.ResearchGroup.SpinOff_CompanyTitle ?? "Άγνωστος Τίτλος")
                                                    </h6>
                                                    <span class="badge bg-info ms-2 badge-sm">
                                                        Spin-Off
                                                    </span>
                                                </div>

                                                <!-- CompanyModel Basic Info -->
                                                <div class="project-info flex-grow-1">
                                                    <div class="mb-1">
                                                        <small class="text-muted">ΑΦΜ:</small>
                                                        <span class="ms-1">@(company?.ResearchGroup.SpinOff_CompanyAFM ?? "Δεν δηλώθηκε")</span>
                                                    </div>
                                                </div>

                                                <!-- CompanyModel Description (if available) -->
                                                @if (!string.IsNullOrEmpty(company?.ResearchGroup.SpinOff_CompanyDescription))
                                                {
                                                    <div class="mt-2">
                                                        <small class="text-muted">Περιγραφή:</small>
                                                        <p class="mb-0 mt-1 small">@company.ResearchGroup.SpinOff_CompanyDescription</p>
                                                    </div>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                </div>
            </div>
        }
        @if (ipodomes?.Any() == true)
        {
            <div class="info-card">
                <div class="expandable-section">
                    <div class="section-header" @onclick='() => ToggleSection("ipodomes")' id="ipodomes">
                        <h3 class="section-title-expandable">
                            <i class="fas fa-server"></i>Υποδομές (@ipodomes.Count)
                        </h3>
                        <i class="fas fa-chevron-down chevron-icon @(expandedSections.Contains("ipodomes") ? "chevron-rotated" : "")"></i>
                    </div>
                    @if (expandedSections.Contains("ipodomes"))
                    {
                        <div class="section-content">
                            <div class="row">
                                @foreach (var item in GetPaginatedIpodomes())
                                {
                                    <div class="col-lg-6 col-xl-4 mb-3">
                                        <div class="project-card-compact" style="border-left: 4px solid #6f42c1;">
                                            <div class="d-flex flex-column h-100 p-3">
                                                <div class="d-flex align-items-start gap-3 mb-2">
                                                    <div class="flex-shrink-0">
                                                        @if (item.ResearchGroup_Ipodomes_Images != null && item.ResearchGroup_Ipodomes_Images.Length > 0)
                                                        {
                                                            <img src="data:image/jpeg;base64,@Convert.ToBase64String(item.ResearchGroup_Ipodomes_Images)" 
                                                                 class="rounded" style="width: 50px; height: 50px; object-fit: cover; border: 1px solid #dee2e6;" />
                                                        }
                                                        else
                                                        {
                                                            <div class="rounded d-flex align-items-center justify-content-center" 
                                                                 style="width: 50px; height: 50px; background-color: #f8f9fa; border: 1px solid #dee2e6;">
                                                                <i class="fas fa-server text-muted"></i>
                                                            </div>
                                                        }
                                                    </div>
                                                    <h6 class="project-title" style="color: #2d3748; margin-bottom: 0; flex: 1;">
                                                        @(item.ResearchGroup_Ipodomes_Title ?? "Άγνωστος Τίτλος")
                                                    </h6>
                                                </div>

                                                <div class="project-info flex-grow-1">
                                                    <p class="text-muted small mb-2" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                                        @item.ResearchGroup_Ipodomes_Description
                                                    </p>
                                                    @if (!string.IsNullOrEmpty(item.ResearchGroup_Ipodomes_Keywords))
                                                    {
                                                        <div class="d-flex flex-wrap gap-1 mt-1">
                                                            @foreach(var tag in item.ResearchGroup_Ipodomes_Keywords.Split(',').Take(3))
                                                            {
                                                                <span class="badge bg-light text-dark border badge-sm">@tag.Trim()</span>
                                                            }
                                                        </div>
                                                    }
                                                </div>

                                                <div class="details-button-container mt-2 pt-2 border-top">
                                                    <div class="badges-container">
                                                        <span class="badge text-white badge-sm" style="background-color: #6f42c1;">Υποδομή</span>
                                                    </div>
                                                    <button class="custom-details-button" 
                                                            style="color: #6f42c1; border-color: #6f42c1; background: transparent;"
                                                            onmouseover="this.style.backgroundColor='#6f42c1'; this.style.color='white';"
                                                            onmouseout="this.style.backgroundColor='transparent'; this.style.color='#6f42c1';"
                                                            @onclick="@(() => ShowIpodomeDetails(item))"
                                                            title="Προβολή Λεπτομερειών">
                                                        <i class="fas fa-eye me-1"></i>Λεπτόμ.
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>

                            @if (ipodomes.Any())
                            {
                                <div class="d-flex justify-content-center align-items-center mt-4 gap-1">
                                    <span class="pagination-item @(currentPageIpodomes == 1 ? "disabled" : "")" @onclick="GoToFirstPageIpodomes"></span>
                                    <span class="pagination-item @(currentPageIpodomes == 1 ? "disabled" : "")" @onclick="PreviousPageIpodomes"></span>
                            
                                    @foreach (var pageNumber in GetVisiblePagesIpodomes())
                                    {
                                        if (pageNumber == -1) { <span class="pagination-ellipsis">...</span> }
                                        else
                                        {
                                            <span class="pagination-item @(pageNumber == currentPageIpodomes ? "active" : "")" 
                                                  @onclick="() => GoToPageIpodomes(pageNumber)">@pageNumber</span>
                                        }
                                    }
                            
                                    <span class="pagination-item @(currentPageIpodomes == totalPagesIpodomes ? "disabled" : "")" @onclick="NextPageIpodomes">></span>
                                    <span class="pagination-item @(currentPageIpodomes == totalPagesIpodomes ? "disabled" : "")" @onclick="GoToLastPageIpodomes">>></span>
                                    <span class="ms-3 small text-muted">Σελίδα @currentPageIpodomes από @totalPagesIpodomes</span>
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        }

    }
</div>

@code {
    private List<AnnouncementAsResearchGroup> announcements = new();
    private bool showAnnouncementModal = false;
    private AnnouncementAsResearchGroup? selectedAnnouncement = null;
    private int currentPageAnnouncements = 1;
    private const int pageSizeAnnouncements = 4; // Match others (6 items per page)

    private int totalPagesAnnouncements => (int)Math.Ceiling((double)announcements.Count / pageSizeAnnouncements);

    private IEnumerable<AnnouncementAsResearchGroup> GetPaginatedAnnouncements()
    {
        return announcements
            .Skip((currentPageAnnouncements - 1) * pageSizeAnnouncements)
            .Take(pageSizeAnnouncements);
    }

    private void GoToFirstPageAnnouncements() => currentPageAnnouncements = 1;
    private void PreviousPageAnnouncements()
    {
        if (currentPageAnnouncements > 1) currentPageAnnouncements--;
    }
    private void GoToPageAnnouncements(int page) => currentPageAnnouncements = page;
    private void NextPageAnnouncements()
    {
        if (currentPageAnnouncements < totalPagesAnnouncements) currentPageAnnouncements++;
    }
    private void GoToLastPageAnnouncements() => currentPageAnnouncements = totalPagesAnnouncements;

    private List<int> GetVisiblePagesAnnouncements()
    {
        var pages = new List<int>();
        int current = currentPageAnnouncements;
        int total = totalPagesAnnouncements;

        if (total <= 1) return pages;

        pages.Add(1);
        if (current > 3) pages.Add(-1);

        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);

        for (int i = start; i <= end; i++) pages.Add(i);

        if (current < total - 2) pages.Add(-1);
        if (total > 1) pages.Add(total);

        return pages;
    }

    // --- Announcement Modal Logic ---
    private void ShowAnnouncementDetails(AnnouncementAsResearchGroup announcement)
    {
        selectedAnnouncement = announcement;
        showAnnouncementModal = true;
        StateHasChanged();
    }

    private void CloseAnnouncementModal()
    {
        showAnnouncementModal = false;
        selectedAnnouncement = null;
        StateHasChanged();
    }

    private StudentDetail? selectedStudentDetails;

    private HashSet<string> expandedSections = new HashSet<string>();
    private void ToggleSection(string sectionId)
    {
        if (expandedSections.Contains(sectionId))
        {
            expandedSections.Remove(sectionId);
        }
        else
        {
            expandedSections.Add(sectionId);
        }
        StateHasChanged();
    }

    private bool showAllPublications = false;

    private void ToggleAllPublications()
    {
        showAllPublications = !showAllPublications;
        StateHasChanged();
    }

    [SupplyParameterFromQuery(Name = "id")]
    public string ResearchGroupId { get; set; } = string.Empty;
    private ResearchGroupModel? researchGroup;
    private List<ResearchGroup_Professors> professors = new();
    private List<ResearchGroup_NonFacultyMembers> students = new();
    private List<ResearchGroup_ResearchActions> projects = new();
    private List<ResearchGroup_Publications> publications = new();
    private List<ResearchGroup_Patents> patents = new();
    private List<ResearchGroup_SpinOffCompany> spinOffCompanies = new();
    private List<ProfessorDetail> professorDetails = new();
    private List<StudentDetail> studentDetails = new();
    private bool isLoading = true;
    private bool hasError = false;
    private string errorMessage = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            Console.WriteLine($"ResearchGroupDetails: Initial ResearchGroupId from query: {ResearchGroupId}");
            Console.WriteLine($"ResearchGroupDetails: Page Type: {this.GetType().Name}");
            Console.WriteLine($"ResearchGroupDetails: Layout in use: FullScreenLayout");

            // If ResearchGroupId is empty, try to extract from URL
            if (string.IsNullOrEmpty(ResearchGroupId))
            {
                var currentUri = NavigationManager.ToAbsoluteUri(NavigationManager.Uri);
                Console.WriteLine($"ResearchGroupDetails: Current URI: {currentUri}");

                // Try to get from query string
                if (Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(currentUri.Query).TryGetValue("id", out var idFromQuery))
                {
                    ResearchGroupId = idFromQuery;
                    Console.WriteLine($"ResearchGroupDetails: Found ID from query string: {ResearchGroupId}");
                }

                // If still empty, try to parse from path (backward compatibility)
                if (string.IsNullOrEmpty(ResearchGroupId) && currentUri.AbsolutePath.StartsWith("/researchGroupDetails/"))
                {
                    var pathSegments = currentUri.AbsolutePath.Split('/');
                    if (pathSegments.Length >= 3)
                    {
                        ResearchGroupId = pathSegments[2];
                        Console.WriteLine($"ResearchGroupDetails: Found ID from path: {ResearchGroupId}");
                    }
                }
            }

            if (string.IsNullOrEmpty(ResearchGroupId))
            {
                Console.WriteLine("ResearchGroupDetails: ResearchGroupId is null or empty");
                hasError = true;
                errorMessage = "Δεν παρέχεται ID ερευνητικής ομάδας";
                return;
            }

            Console.WriteLine($"ResearchGroupDetails: Loading details for ID: {ResearchGroupId}");
            await LoadResearchGroupDetails();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"ResearchGroupDetails: Error in OnInitializedAsync - {ex.Message}");
            Console.WriteLine($"ResearchGroupDetails: Stack trace - {ex.StackTrace}");
            hasError = true;
            errorMessage = $"Σφάλμα φόρτωσης: {ex.Message}";
            isLoading = false;
            StateHasChanged();
        }
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try
            {
                await JSRuntime.InvokeVoidAsync("console.log", "ResearchGroupDetails: First render completed in new tab");

                // Prevent navigation away from this page
                await JSRuntime.InvokeVoidAsync("eval",
                    "if (window.location.pathname.includes('/researchGroupDetails')) { " +
                    "console.log('Preventing navigation away from research group page'); " +
                    "window.history.replaceState(null, '', window.location.href); " +
                    "}");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"ResearchGroupDetails: Error in OnAfterRenderAsync - {ex.Message}");
            }
        }
    }

    private async Task LoadResearchGroupDetails()
    {
        isLoading = true;
        hasError = false;
        StateHasChanged();

        try
        {
            using var context = DbContextFactory.CreateDbContext();

            researchGroup = await context.ResearchGroups
                .FirstOrDefaultAsync(rg => rg.ResearchGroup.UniqueID == ResearchGroupId);

            if (researchGroup != null)
            {
                await LoadRelatedData(context);

                await LoadProfessorDetails(context);
                await LoadStudentDetails(context);
            }
            else
            {
                hasError = true;
                errorMessage = "Η ερευνητική ομάδα δεν βρέθηκε";
            }
        }
        catch (Exception ex)
        {
            hasError = true;
            errorMessage = $"Σφάλμα φόρτωσης δεδομένων: {ex.Message}";
        }
        finally
        {
            isLoading = false;
            StateHasChanged();
        }
    }

    private async Task LoadRelatedData(AppDbContext context)
    {
        try
        {
            var researchGroupEmail = researchGroup?.ResearchGroupEmail;
            if (string.IsNullOrEmpty(researchGroupEmail))
                return;

            professors = await context.ResearchGroup_Professors
                .Where(p => p.PK_ResearchGroupEmail == researchGroupEmail)
                .ToListAsync() ?? new List<ResearchGroup_Professors>();

            students = await context.ResearchGroup_NonFacultyMembers
                .Where(s => s.PK_ResearchGroupEmail == researchGroupEmail)
                .ToListAsync() ?? new List<ResearchGroup_NonFacultyMembers>();

            projects = await context.ResearchGroup_ResearchActions
                .Where(p => p.ResearchGroupEmail == researchGroupEmail)
                .ToListAsync() ?? new List<ResearchGroup_ResearchActions>();

            publications = await context.ResearchGroup_Publications
                .Where(p => p.PK_ResearchGroupEmail == researchGroupEmail)
                .OrderByDescending(p => p.PK_ResearchGroupMemberPublication_Year)
                .ToListAsync() ?? new List<ResearchGroup_Publications>();

            patents = await context.ResearchGroup_Patents
                .Where(p => p.ResearchGroupEmail == researchGroupEmail)
                .ToListAsync() ?? new List<ResearchGroup_Patents>();

            spinOffCompanies = await context.ResearchGroup_SpinOffCompany
                .Where(s => s.ResearchGroupEmail == researchGroupEmail)
                .ToListAsync() ?? new List<ResearchGroup_SpinOffCompany>();

            announcements = await context.AnnouncementAsResearchGroup
                .Where(a => a.ResearchGroupAnnouncementResearchGroupEmail == researchGroupEmail)
                .OrderByDescending(a => a.ResearchGroupAnnouncementUploadDate)
                .ToListAsync() ?? new List<AnnouncementAsResearchGroup>();

            ipodomes = await context.ResearchGroup_Ipodomes
                .Where(i => i.ResearchGroupEmail == researchGroupEmail)
                .ToListAsync() ?? new List<ResearchGroup_Ipodomes>();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading related data: {ex.Message}");
        }
    }


    private async Task LoadProfessorDetails(AppDbContext context)
    {
        professorDetails.Clear();

        if (professors == null || !professors.Any())
            return;

        foreach (var professor in professors)
        {
            try
            {
                if (string.IsNullOrEmpty(professor?.PK_ProfessorEmail))
                    continue;

                var professorUser = await context.Professors
                    .FirstOrDefaultAsync(u => u.ProfEmail == professor.PK_ProfessorEmail);

                if (professorUser != null)
                {
                    professorDetails.Add(new ProfessorDetail
                        {
                            Name = professorUser.ProfName ?? string.Empty,
                            Surname = professorUser.ProfSurname ?? string.Empty,
                            Email = professor.PK_ProfessorEmail ?? string.Empty,
                            Role = professor.PK_ProfessorRole ?? string.Empty,
                            University = professorUser.ProfUniversity ?? string.Empty,
                            Department = professorUser.ProfDepartment ?? string.Empty,
                            Vathmida = professorUser.ProfVahmidaDEP ?? string.Empty,
                            GoogleScholarProfile = professorUser.ProfScholarProfile ?? string.Empty,
                            RegistrationDate = professor.DateOfRegistrationOnResearchGroup_ForProfessorMember,
                            ProfImage = professorUser.ProfImage ?? Array.Empty<byte>()
                        });
                }
                else
                {
                    professorDetails.Add(new ProfessorDetail
                        {
                            Name = "Άγνωστο",
                            Surname = "Καθηγητής",
                            Email = professor.PK_ProfessorEmail ?? string.Empty,
                            Role = professor.PK_ProfessorRole ?? string.Empty,
                            RegistrationDate = professor.DateOfRegistrationOnResearchGroup_ForProfessorMember
                        });
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error loading professor details for {professor?.PK_ProfessorEmail}: {ex.Message}");
            }
        }
    }

    private async Task LoadStudentDetails(AppDbContext context)
    {
        studentDetails.Clear();

        if (students == null || !students.Any())
            return;

        foreach (var student in students)
        {
            try
            {
                if (string.IsNullOrEmpty(student?.PK_NonFacultyMemberEmail))
                    continue;

                var studentUser = await context.Students
                    .FirstOrDefaultAsync(u => u.Email == student.PK_NonFacultyMemberEmail);

                if (studentUser != null)
                {
                    studentDetails.Add(new StudentDetail
                        {
                            Name = studentUser.Name ?? string.Empty,
                            Surname = studentUser.Surname ?? string.Empty,
                            Email = student.PK_NonFacultyMemberEmail ?? string.Empty,
                            Role = student.PK_NonFacultyMemberLevelOfStudies ?? string.Empty,
                            LevelOfStudies = student.PK_NonFacultyMemberLevelOfStudies ?? string.Empty,
                            University = studentUser.University ?? string.Empty,
                            Department = studentUser.Department ?? string.Empty,
                            PersonalWebsite = studentUser.PersonalWebsite ?? string.Empty,
                            RegistrationDate = student.DateOfRegistrationOnResearchGroup_ForNonFacultyMember,
                            Image = studentUser.Image ?? Array.Empty<byte>()
                        });
                }
                else
                {
                    studentDetails.Add(new StudentDetail
                        {
                            Name = "Άγνωστο",
                            Surname = "Συνεργάτης",
                            Email = student.PK_NonFacultyMemberEmail ?? string.Empty,
                            Role = student.PK_NonFacultyMemberLevelOfStudies ?? string.Empty,
                            LevelOfStudies = student.PK_NonFacultyMemberLevelOfStudies ?? string.Empty,
                            RegistrationDate = student.DateOfRegistrationOnResearchGroup_ForNonFacultyMember
                        });
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error loading student details for {student?.PK_NonFacultyMemberEmail}: {ex.Message}");
            }
        }
    }

    private string GetYoutubeEmbedUrl(string? url)
    {
        if (string.IsNullOrEmpty(url)) return string.Empty;

        try
        {
            var videoId = string.Empty;
            if (url.Contains("youtube.com/watch?v="))
            {
                videoId = url.Split("v=")[1].Split('&')[0];
            }
            else if (url.Contains("youtu.be/"))
            {
                videoId = url.Split("youtu.be/")[1].Split('?')[0];
            }
            else if (url.Contains("youtube.com/embed/"))
            {
                videoId = url.Split("embed/")[1].Split('?')[0];
            }

            return string.IsNullOrEmpty(videoId) ? string.Empty : $"https://www.youtube.com/embed/{videoId}";
        }
        catch
        {
            return string.Empty;
        }
    }

    private async Task DownloadPresentationAttachment()
    {
        try
        {
            if (researchGroup?.ResearchGroup_PresentationAttachment != null && researchGroup.ResearchGroup_PresentationAttachment.Length > 0)
            {
                var fileName = $"Presentation_{(researchGroup.ResearchGroupName ?? "ResearchGroup")}_{DateTime.Now:yyyyMMdd}.pdf";
                await JSRuntime.InvokeVoidAsync("downloadFile",
                    Convert.ToBase64String(researchGroup.ResearchGroup_PresentationAttachment),
                    fileName,
                    "application/pdf");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error downloading attachment: {ex.Message}");
        }
    }

    private async Task NavigateBack()
    {
        Console.WriteLine("ResearchGroupDetails: NavigateBack called");

        // First, check if we can go back in history
        var canGoBack = await JSRuntime.InvokeAsync<bool>("eval", "window.history.length > 1");

        if (canGoBack)
        {
            // If there's history, go back
            await JSRuntime.InvokeVoidAsync("history.back");
        }
        else
        {
            // If no history, try to close the tab
            try
            {
                await JSRuntime.InvokeVoidAsync("window.close");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Cannot close window: {ex.Message}");
                // Fallback: navigate to home or research groups list
                NavigationManager.NavigateTo("/research-groups");
            }
        }
    }

    private class ProfessorDetail
    {
        public string Name { get; set; } = string.Empty;
        public string Surname { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        public string Role { get; set; } = string.Empty;
        public string University { get; set; } = string.Empty;
        public string Department { get; set; } = string.Empty;
        public string Vathmida { get; set; } = string.Empty;
        public string GoogleScholarProfile { get; set; } = string.Empty;
        public byte[] ProfImage { get; set; } = Array.Empty<byte>();
        public DateTime RegistrationDate { get; set; }
    }

    private class StudentDetail
    {
        public string Name { get; set; } = string.Empty;
        public string Surname { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        public string Role { get; set; } = string.Empty;
        public string LevelOfStudies { get; set; } = string.Empty;
        public string University { get; set; } = string.Empty;
        public string Department { get; set; } = string.Empty;
        public string PersonalWebsite { get; set; } = string.Empty;
        public byte[] Image { get; set; } = Array.Empty<byte>();
        public DateTime RegistrationDate { get; set; }
    }

    private async Task NavigateToSection(string sectionId)
    {
        if (!expandedSections.Contains(sectionId))
        {
            expandedSections.Add(sectionId);
            StateHasChanged();

            await Task.Delay(100);
        }

        await JSRuntime.InvokeVoidAsync("scrollToSection", sectionId);
    }

    private string GetGoogleMapsUrl(string address)
    {
        if (string.IsNullOrEmpty(address) || address == "Δεν δηλώθηκε")
            return "#";

        var encodedAddress = Uri.EscapeDataString(address);
        return $"https://www.google.com/maps/search/?api=1&query={encodedAddress}";
    }

    private bool showVideoModal = false;
    private void OpenVideoModal()
    {
        showVideoModal = true;
        StateHasChanged();
    }

    private void CloseVideoModal()
    {
        showVideoModal = false;
        StateHasChanged();
    }

    private string GetYoutubeThumbnailUrl(string? url)
    {
        if (string.IsNullOrEmpty(url)) return string.Empty;

        try
        {
            var videoId = string.Empty;
            if (url.Contains("youtube.com/watch?v="))
            {
                videoId = url.Split("v=")[1].Split('&')[0];
            }
            else if (url.Contains("youtu.be/"))
            {
                videoId = url.Split("youtu.be/")[1].Split('?')[0];
            }
            else if (url.Contains("youtube.com/embed/"))
            {
                videoId = url.Split("embed/")[1].Split('?')[0];
            }

            return string.IsNullOrEmpty(videoId) ? string.Empty : $"https://img.youtube.com/vi/{videoId}/hqdefault.jpg";
        }
        catch
        {
            return string.Empty;
        }
    }

    private bool showProfessorModal = false;
    private ProfessorDetail? selectedProfessor = null;
    private ProfessorModel? selectedProfessorFullDetails = null;

    private async void ShowProfessorDetails(ProfessorDetail professor)
    {
        selectedProfessor = professor;

        // Load full professor details from database
        await LoadFullProfessorDetails(professor.Email);

        showProfessorModal = true;
        StateHasChanged();
    }

    private async Task LoadFullProfessorDetails(string professorEmail)
    {
        try
        {
            using var context = DbContextFactory.CreateDbContext();
            selectedProfessorFullDetails = await context.Professors
                .FirstOrDefaultAsync(p => p.ProfEmail == professorEmail);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading full professor details: {ex.Message}");
            selectedProfessorFullDetails = null;
        }
    }

    private void CloseProfessorModal()
    {
        showProfessorModal = false;
        selectedProfessor = null;
        selectedProfessorFullDetails = null;
        StateHasChanged();
    }

    private bool showStudentModal = false;
    private StudentDetail? selectedStudent = null;
    private StudentModel? selectedStudentFullDetails = null;

    private async void ShowStudentDetails(StudentDetail student)
    {
        selectedStudent = student;

        // Load full student details from database
        await LoadFullStudentDetails(student.Email);

        showStudentModal = true;
        StateHasChanged();
    }

    private async Task LoadFullStudentDetails(string studentEmail)
    {
        try
        {
            using var context = DbContextFactory.CreateDbContext();
            selectedStudentFullDetails = await context.Students
                .FirstOrDefaultAsync(s => s.Email == studentEmail);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading full student details: {ex.Message}");
            selectedStudentFullDetails = null;
        }
    }

    private void CloseStudentModal()
    {
        showStudentModal = false;
        selectedStudent = null;
        selectedStudentFullDetails = null;
        StateHasChanged();
    }

    // Pagination variables for Professors
    private int currentPageProfessors = 1;
    private const int pageSizeProfessors = 6; // Show 6 professors per page (2 per row in 3-column layout)

    // Computed properties for pagination
    private int totalPagesProfessors => (int)Math.Ceiling((double)professorDetails.Count / pageSizeProfessors);
    private IEnumerable<ProfessorDetail> GetPaginatedProfessors()
    {
        return professorDetails
            .Skip((currentPageProfessors - 1) * pageSizeProfessors)
            .Take(pageSizeProfessors);
    }

    // Pagination methods for Professors
    private void GoToFirstPageProfessors()
    {
        if (currentPageProfessors != 1)
        {
            currentPageProfessors = 1;
        }
    }

    private void PreviousPageProfessors()
    {
        if (currentPageProfessors > 1)
        {
            currentPageProfessors--;
        }
    }

    private void GoToPageProfessors(int pageNumber)
    {
        if (pageNumber >= 1 && pageNumber <= totalPagesProfessors)
        {
            currentPageProfessors = pageNumber;
        }
    }

    private void NextPageProfessors()
    {
        if (currentPageProfessors < totalPagesProfessors)
        {
            currentPageProfessors++;
        }
    }

    private void GoToLastPageProfessors()
    {
        if (currentPageProfessors != totalPagesProfessors)
        {
            currentPageProfessors = totalPagesProfessors;
        }
    }

    private List<int> GetVisiblePagesProfessors()
    {
        var pages = new List<int>();
        int current = currentPageProfessors;
        int total = totalPagesProfessors;

        if (total <= 1) return pages;

        // Always show first page
        pages.Add(1);

        if (current > 3)
        {
            pages.Add(-1); // Ellipsis
        }

        // Calculate range of pages to show around current page
        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);

        for (int i = start; i <= end; i++)
        {
            pages.Add(i);
        }

        if (current < total - 2)
        {
            pages.Add(-1); // Ellipsis
        }

        // Always show last page if there's more than one page
        if (total > 1)
        {
            pages.Add(total);
        }

        return pages;
    }

    // Pagination variables for Students
    private int currentPageStudents = 1;
    private const int pageSizeStudents = 6; // Show 6 students per page (2 per row in 3-column layout)

    // Computed properties for pagination
    private int totalPagesStudents => (int)Math.Ceiling((double)studentDetails.Count / pageSizeStudents);
    private IEnumerable<StudentDetail> GetPaginatedStudents()
    {
        return studentDetails
            .Skip((currentPageStudents - 1) * pageSizeStudents)
            .Take(pageSizeStudents);
    }

    // Pagination methods for Students
    private void GoToFirstPageStudents()
    {
        if (currentPageStudents != 1)
        {
            currentPageStudents = 1;
        }
    }

    private void PreviousPageStudents()
    {
        if (currentPageStudents > 1)
        {
            currentPageStudents--;
        }
    }

    private void GoToPageStudents(int pageNumber)
    {
        if (pageNumber >= 1 && pageNumber <= totalPagesStudents)
        {
            currentPageStudents = pageNumber;
        }
    }

    private void NextPageStudents()
    {
        if (currentPageStudents < totalPagesStudents)
        {
            currentPageStudents++;
        }
    }

    private void GoToLastPageStudents()
    {
        if (currentPageStudents != totalPagesStudents)
        {
            currentPageStudents = totalPagesStudents;
        }
    }

    private List<int> GetVisiblePagesStudents()
    {
        var pages = new List<int>();
        int current = currentPageStudents;
        int total = totalPagesStudents;

        if (total <= 1) return pages;

        // Always show first page
        pages.Add(1);

        if (current > 3)
        {
            pages.Add(-1); // Ellipsis
        }

        // Calculate range of pages to show around current page
        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);

        for (int i = start; i <= end; i++)
        {
            pages.Add(i);
        }

        if (current < total - 2)
        {
            pages.Add(-1); // Ellipsis
        }

        // Always show last page if there's more than one page
        if (total > 1)
        {
            pages.Add(total);
        }

        return pages;
    }

    // Pagination variables for Projects
    private int currentPageProjects = 1;
    private const int pageSizeProjects = 6; // Show 6 projects per page

    // Computed properties for pagination
    private int totalPagesProjects => (int)Math.Ceiling(filteredProjects.Count() / (double)pageSizeProjects);
    private IEnumerable<ResearchGroup_ResearchActions> GetPaginatedProjects()
    {
        var itemsToShow = filteredProjects; // Use filteredProjects instead of projects

        return itemsToShow
            .Skip((currentPageProjects - 1) * pageSizeProjects)
            .Take(pageSizeProjects);
    }

    // Pagination methods for Projects
    private void GoToFirstPageProjects()
    {
        if (currentPageProjects != 1)
        {
            currentPageProjects = 1;
        }
    }

    private void PreviousPageProjects()
    {
        if (currentPageProjects > 1)
        {
            currentPageProjects--;
        }
    }

    private void GoToPageProjects(int pageNumber)
    {
        if (pageNumber >= 1 && pageNumber <= totalPagesProjects)
        {
            currentPageProjects = pageNumber;
        }
    }

    private void NextPageProjects()
    {
        if (currentPageProjects < totalPagesProjects)
        {
            currentPageProjects++;
        }
    }

    private void GoToLastPageProjects()
    {
        if (currentPageProjects != totalPagesProjects)
        {
            currentPageProjects = totalPagesProjects;
        }
    }

    private List<int> GetVisiblePagesProjects()
    {
        var pages = new List<int>();
        int current = currentPageProjects;
        int total = totalPagesProjects;

        if (total <= 1) return pages;

        pages.Add(1);

        if (current > 3)
        {
            pages.Add(-1); 
        }

        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);

        for (int i = start; i <= end; i++)
        {
            pages.Add(i);
        }

        if (current < total - 2)
        {
            pages.Add(-1); 
        }

        if (total > 1)
        {
            pages.Add(total);
        }

        return pages;
    }

    private bool showProjectModal = false;
    private ResearchGroup_ResearchActions? selectedProject = null;

    private void ShowProjectDetails(ResearchGroup_ResearchActions project)
    {
        selectedProject = project;
        showProjectModal = true;
        StateHasChanged();
    }

    private void CloseProjectModal()
    {
        showProjectModal = false;
        selectedProject = null;
        StateHasChanged();
    }

    private string projectStatusFilter = "all";
    private IEnumerable<ResearchGroup_ResearchActions> filteredProjects => GetFilteredProjects();

    private IEnumerable<ResearchGroup_ResearchActions> GetFilteredProjects()
    {
        if (projectStatusFilter == "all")
        {
            return projects;
        }
        else if (projectStatusFilter == "OnGoing")
        {
            return projects.Where(p => p.ResearchGroup.ProjectStatus == "OnGoing");
        }
        else // "Past"
        {
            return projects.Where(p => p.ResearchGroup.ProjectStatus == "Past");
        }
    }

    private void OnProjectFilterChanged()
    {
        currentPageProjects = 1;
        StateHasChanged();
    }

    // Patent variables
    private bool showPatentModal = false;
    private ResearchGroup_Patents? selectedPatent = null;
    private string patentStatusFilter = "all";
    private int currentPagePatents = 1;
    private const int pageSizePatents = 6;

    // Computed properties for patent pagination
    private int totalPagesPatents => (int)Math.Ceiling(filteredPatents.Count() / (double)pageSizePatents);
    private IEnumerable<ResearchGroup_Patents> filteredPatents => GetFilteredPatents();

    private IEnumerable<ResearchGroup_Patents> GetFilteredPatents()
    {
        if (patentStatusFilter == "all")
        {
            return patents;
        }
        else if (patentStatusFilter == "Ενεργή")
        {
            return patents.Where(p => p.ResearchGroup.Patent_PatentStatus == "Ενεργή");
        }
        else // "Ανενεργή"
        {
            return patents.Where(p => p.ResearchGroup.Patent_PatentStatus != "Ενεργή");
        }
    }

    private IEnumerable<ResearchGroup_Patents> GetPaginatedPatents()
    {
        var itemsToShow = filteredPatents;

        return itemsToShow
            .Skip((currentPagePatents - 1) * pageSizePatents)
            .Take(pageSizePatents);
    }

    // Patent modal methods
    private void ShowPatentDetails(ResearchGroup_Patents patent)
    {
        selectedPatent = patent;
        showPatentModal = true;
        StateHasChanged();
    }

    private void ClosePatentModal()
    {
        showPatentModal = false;
        selectedPatent = null;
        StateHasChanged();
    }

    // Patent pagination methods
    private void GoToFirstPagePatents() => currentPagePatents = 1;
    private void GoToLastPagePatents() => currentPagePatents = totalPagesPatents;
    private void PreviousPagePatents() => currentPagePatents = Math.Max(1, currentPagePatents - 1);
    private void NextPagePatents() => currentPagePatents = Math.Min(totalPagesPatents, currentPagePatents + 1);
    private void GoToPagePatents(int page) => currentPagePatents = page;

    private List<int> GetVisiblePagesPatents()
    {
        var pages = new List<int>();
        int current = currentPagePatents;
        int total = totalPagesPatents;

        if (total <= 1) return pages;

        pages.Add(1);

        if (current > 3)
        {
            pages.Add(-1);
        }

        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);

        for (int i = start; i <= end; i++)
        {
            pages.Add(i);
        }

        if (current < total - 2)
        {
            pages.Add(-1);
        }

        if (total > 1)
        {
            pages.Add(total);
        }

        return pages;
    }

    // Patent filter change handler
    private void OnPatentFilterChanged()
    {
        currentPagePatents = 1;
        StateHasChanged();
    }

    // Publications pagination variables
    private int currentPublicationsPage = 1;
    private int publicationsPerPage = 10;

    // Computed properties for publications pagination
    private int totalPublicationsPages => (int)Math.Ceiling((double)publications.Count / publicationsPerPage);
    private IEnumerable<ResearchGroup_Publications> GetPaginatedPublications()
    {
        return publications
            .OrderByDescending(p => p.PK_ResearchGroupMemberPublication_Year)
            .Skip((currentPublicationsPage - 1) * publicationsPerPage)
            .Take(publicationsPerPage);
    }

    // Publications pagination methods
    private void GoToFirstPagePublications() => currentPublicationsPage = 1;
    private void GoToLastPagePublications() => currentPublicationsPage = totalPublicationsPages;
    private void PreviousPagePublications() => currentPublicationsPage = Math.Max(1, currentPublicationsPage - 1);
    private void NextPagePublications() => currentPublicationsPage = Math.Min(totalPublicationsPages, currentPublicationsPage + 1);
    private void GoToPagePublications(int page) => currentPublicationsPage = page;

    private List<int> GetVisiblePagesPublications()
    {
        var pages = new List<int>();
        int current = currentPublicationsPage;
        int total = totalPublicationsPages;

        if (total <= 1) return pages;

        pages.Add(1);

        if (current > 3)
        {
            pages.Add(-1);
        }

        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);

        for (int i = start; i <= end; i++)
        {
            pages.Add(i);
        }

        if (current < total - 2)
        {
            pages.Add(-1);
        }

        if (total > 1)
        {
            pages.Add(total);
        }

        return pages;
    }

     // Helper method to extract YouTube ID from URL
    private string ExtractYouTubeId(string url)
    {
        if (string.IsNullOrEmpty(url))
            return string.Empty;

        // Handle various YouTube URL formats
        var uri = new Uri(url);
        if (uri.Host.Contains("youtu.be"))
        {
            return uri.Segments.Last();
        }
        else if (uri.Host.Contains("youtube.com"))
        {
            var query = System.Web.HttpUtility.ParseQueryString(uri.Query);
            return query["v"];
        }
        
        return string.Empty;
    }

    private List<ResearchGroup_Ipodomes> ipodomes = new(); 
    private bool showIpodomeModal = false;
    private ResearchGroup_Ipodomes? selectedIpodome = null;
    private int currentPageIpodomes = 1;
    private const int pageSizeIpodomes = 6;
    private int totalPagesIpodomes => (int)Math.Ceiling((double)ipodomes.Count / pageSizeIpodomes);

    private IEnumerable<ResearchGroup_Ipodomes> GetPaginatedIpodomes()
    {
        return ipodomes
            .Skip((currentPageIpodomes - 1) * pageSizeIpodomes)
            .Take(pageSizeIpodomes);
    }

    private void GoToFirstPageIpodomes() => currentPageIpodomes = 1;
    private void PreviousPageIpodomes() { if (currentPageIpodomes > 1) currentPageIpodomes--; }
    private void GoToPageIpodomes(int page) => currentPageIpodomes = page;
    private void NextPageIpodomes() { if (currentPageIpodomes < totalPagesIpodomes) currentPageIpodomes++; }
    private void GoToLastPageIpodomes() => currentPageIpodomes = totalPagesIpodomes;

    private List<int> GetVisiblePagesIpodomes()
    {
        // Re-using logic from other sections
        var pages = new List<int>();
        int current = currentPageIpodomes;
        int total = totalPagesIpodomes;
        if (total <= 1) return pages;
        pages.Add(1);
        if (current > 3) pages.Add(-1);
        int start = Math.Max(2, current - 1);
        int end = Math.Min(total - 1, current + 1);
        for (int i = start; i <= end; i++) pages.Add(i);
        if (current < total - 2) pages.Add(-1);
        if (total > 1) pages.Add(total);
        return pages;
    }

    private void ShowIpodomeDetails(ResearchGroup_Ipodomes item)
    {
        selectedIpodome = item;
        showIpodomeModal = true;
        StateHasChanged();
    }

    private void CloseIpodomeModal()
    {
        showIpodomeModal = false;
        selectedIpodome = null;
        StateHasChanged();
    }

}